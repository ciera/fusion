<html><body><link rel="stylesheet" type="text/css" href="style.css"/><div id="posts"><!-- post #76473 -->
<!-- open content container -->
<div align="center">
<div class="page" style="width:100%; text-align:left">
<div style="padding:0px 0px 0px 0px" align="left">
<div id="edit76473" style="padding:0px 0px 6px 0px">
<!-- this is not the last post shown on the page -->
<table class="tborder" id="post76473" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
			&nbsp;
			#<a href="showpost.php?p=76473&amp;postcount=1" target="new" rel="nofollow" id="postcount76473" name="1"><strong>1</strong></a> &nbsp;
			
			
			<a href="report.php?p=76473" rel="nofollow"><img class="inlineimg" src="images/buttons/report.gif" alt="Report Post" border="0" /></a> &nbsp;
			
			
		</div>
<div class="normal">
<!-- status icon and date -->
<a name="post76473"><img class="inlineimg" src="images/statusicon/post_old.gif" alt="Old" border="0" /></a>
			
				Sep 8th, 2006, 09:27 AM
			
			
			<!-- / status icon and date -->
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<!-- user info -->
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td nowrap="nowrap">
<div id="postmenu_76473">
<a class="bigusername" href="member.php?u=7664">Paul Newport</a>
<img class="inlineimg" src="images/statusicon/user_offline.gif" alt="Paul Newport is offline" border="0" />
<script type="text/javascript"> vbmenu_register("postmenu_76473", true); </script>
</div>
<div class="smallfont">Senior Member</div>
</td>
<td width="100%">&nbsp;</td>
<td valign="top" nowrap="nowrap">
<div class="smallfont">
<div>Join Date: Sep 2004</div>
<div>
						Posts: 576
					</div>
<div> </div>
</div>
</td>
</tr>
</table>
<!-- / user info -->
</td>
</tr>
<tr>
<td class="alt1" id="td_post_76473">
<!-- message, attachments, sig -->
<!-- icon and title -->
<div class="smallfont">
<img class="inlineimg" src="images/icons/icon1.gif" alt="Default" border="0" />
<strong>flow action executes finished sub-flow method</strong>
</div>
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<!-- / icon and title -->
<!-- message -->
<div id="post_message_76473">
			
			I have a JSP with two buttons on it. One (search) goes off to an address search sub-flow, the purpose if which is to search for the entered address, and return this to the main flow.<br />
<br />
Buried within the subflow (i.e. well within the sub-flow), there is an action state with an ID of submit<br />
<br />
The other button is just a next button to the next page in the flow. The flow id associated with this is also called submit.<br />
<br />
If I start up the app and hit next, it goes to the next page as expected.<br />
<br />
If I start the app, hit search to go into the subflow, navigate around the subflow, and eventually return to the main page that called it, and hit next, it does not go to the next page, but executes the submit action state buried within the sub-flow !<br />
<br />
How can this be, has anyone encountered anything like this before ?
		</div>
<!-- / message -->
<div style="margin-top: 10px" align="right">
<!-- controls -->
<a href="newreply.php?do=newreply&amp;p=76473" rel="nofollow"><img src="images/buttons/quote.gif" alt="Reply With Quote" border="0" /></a>
<a href="newreply.php?do=newreply&amp;p=76473" rel="nofollow" onclick="return false"><img src="images/buttons/multiquote_off.gif" alt="Multi-Quote This Message" border="0" id="mq_76473" /></a>
<a href="newreply.php?do=newreply&amp;p=76473" rel="nofollow" id="qr_76473" onclick="return false"><img src="images/buttons/quickreply.gif" alt="Quick reply to this message" border="0" /></a>
<!-- / controls -->
</div>
<!-- message, attachments, sig -->
</td>
</tr>
</table>
<!-- post 76473 popup menu -->
<div class="vbmenu_popup" id="postmenu_76473_menu" style="display:none;">
<table cellpadding="4" cellspacing="1" border="0">
<tr>
<td class="thead">Paul Newport</td>
</tr>
<tr><td class="vbmenu_option"><a href="member.php?u=7664">View Public Profile</a></td></tr>
<tr><td class="vbmenu_option"><a href="private.php?do=newpm&amp;u=7664" rel="nofollow">Send a private message to Paul Newport</a></td></tr>
<tr><td class="vbmenu_option"><a href="search.php?do=finduser&amp;u=7664" rel="nofollow">Find all posts by Paul Newport</a></td></tr>
<tr><td class="vbmenu_option"><a href="profile.php?do=addlist&amp;userlist=buddy&amp;u=7664">Add Paul Newport to Your Contacts</a></td></tr>
</table>
</div>
<!-- / post 76473 popup menu -->
</div>
</div>
</div>
</div>
<!-- / close content container -->
<!-- / post #76473 --><!-- post #76607 -->
<!-- open content container -->
<div align="center">
<div class="page" style="width:100%; text-align:left">
<div style="padding:0px 0px 0px 0px" align="left">
<div id="edit76607" style="padding:0px 0px 6px 0px">
<!-- this is not the last post shown on the page -->
<table class="tborder" id="post76607" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
			&nbsp;
			#<a href="showpost.php?p=76607&amp;postcount=2" target="new" rel="nofollow" id="postcount76607" name="2"><strong>2</strong></a> &nbsp;
			
			
			<a href="report.php?p=76607" rel="nofollow"><img class="inlineimg" src="images/buttons/report.gif" alt="Report Post" border="0" /></a> &nbsp;
			
			
		</div>
<div class="normal">
<!-- status icon and date -->
<a name="post76607"><img class="inlineimg" src="images/statusicon/post_old.gif" alt="Old" border="0" /></a>
			
				Sep 9th, 2006, 11:27 PM
			
			
			<!-- / status icon and date -->
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<!-- user info -->
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td class="alt2"><a href="member.php?u=6371"><img src="image.php?u=6371&amp;dateline=1288973702" width="56" height="77" alt="Keith Donald's Avatar" border="0" /></a></td>
<td nowrap="nowrap">
<div id="postmenu_76607">
<a class="bigusername" href="member.php?u=6371">Keith Donald</a>
<img class="inlineimg" src="images/statusicon/user_offline.gif" alt="Keith Donald is offline" border="0" />
<script type="text/javascript"> vbmenu_register("postmenu_76607", true); </script>
</div>
<div class="smallfont">Web App Development Lead</div>
<div class="smallfont">Spring Team</div>
</td>
<td width="100%">&nbsp;</td>
<td valign="top" nowrap="nowrap">
<div class="smallfont">
<div>Join Date: Aug 2004</div>
<div>Location: Melbourne, FL</div>
<div>
						Posts: 2,555
					</div>
<div> </div>
</div>
</td>
</tr>
</table>
<!-- / user info -->
</td>
</tr>
<tr>
<td class="alt1" id="td_post_76607">
<!-- message, attachments, sig -->
<!-- icon and title -->
<div class="smallfont">
<img class="inlineimg" src="images/icons/icon1.gif" alt="Default" border="0" />
</div>
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<!-- / icon and title -->
<!-- message -->
<div id="post_message_76607">
			
			Could you elaborate what you mean by &quot;navigate around the subflow&quot;?<br />
<br />
What flow execution repository strategy are you using, and what version of SWF?<br />
<br />
Thanks!
		</div>
<!-- / message -->
<!-- sig -->
<div>
				__________________<br />
				Keith Donald<br />
Core Spring Development Team
			</div>
<!-- / sig -->
<div style="margin-top: 10px" align="right">
<!-- controls -->
<a href="newreply.php?do=newreply&amp;p=76607" rel="nofollow"><img src="images/buttons/quote.gif" alt="Reply With Quote" border="0" /></a>
<a href="newreply.php?do=newreply&amp;p=76607" rel="nofollow" onclick="return false"><img src="images/buttons/multiquote_off.gif" alt="Multi-Quote This Message" border="0" id="mq_76607" /></a>
<a href="newreply.php?do=newreply&amp;p=76607" rel="nofollow" id="qr_76607" onclick="return false"><img src="images/buttons/quickreply.gif" alt="Quick reply to this message" border="0" /></a>
<!-- / controls -->
</div>
<!-- message, attachments, sig -->
</td>
</tr>
</table>
<!-- post 76607 popup menu -->
<div class="vbmenu_popup" id="postmenu_76607_menu" style="display:none;">
<table cellpadding="4" cellspacing="1" border="0">
<tr>
<td class="thead">Keith Donald</td>
</tr>
<tr><td class="vbmenu_option"><a href="member.php?u=6371">View Public Profile</a></td></tr>
<tr><td class="vbmenu_option"><a href="private.php?do=newpm&amp;u=6371" rel="nofollow">Send a private message to Keith Donald</a></td></tr>
<tr><td class="vbmenu_option"><a href="http://blog.springsource.com">Visit Keith Donald's homepage!</a></td></tr>
<tr><td class="vbmenu_option"><a href="search.php?do=finduser&amp;u=6371" rel="nofollow">Find all posts by Keith Donald</a></td></tr>
<tr><td class="vbmenu_option"><a href="profile.php?do=addlist&amp;userlist=buddy&amp;u=6371">Add Keith Donald to Your Contacts</a></td></tr>
</table>
</div>
<!-- / post 76607 popup menu -->
</div>
</div>
</div>
</div>
<!-- / close content container -->
<!-- / post #76607 --><!-- post #76716 -->
<!-- open content container -->
<div align="center">
<div class="page" style="width:100%; text-align:left">
<div style="padding:0px 0px 0px 0px" align="left">
<div id="edit76716" style="padding:0px 0px 6px 0px">
<!-- this is not the last post shown on the page -->
<table class="tborder" id="post76716" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
			&nbsp;
			#<a href="showpost.php?p=76716&amp;postcount=3" target="new" rel="nofollow" id="postcount76716" name="3"><strong>3</strong></a> &nbsp;
			
			
			<a href="report.php?p=76716" rel="nofollow"><img class="inlineimg" src="images/buttons/report.gif" alt="Report Post" border="0" /></a> &nbsp;
			
			
		</div>
<div class="normal">
<!-- status icon and date -->
<a name="post76716"><img class="inlineimg" src="images/statusicon/post_old.gif" alt="Old" border="0" /></a>
			
				Sep 11th, 2006, 06:21 AM
			
			
			<!-- / status icon and date -->
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<!-- user info -->
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td nowrap="nowrap">
<div id="postmenu_76716">
<a class="bigusername" href="member.php?u=7664">Paul Newport</a>
<img class="inlineimg" src="images/statusicon/user_offline.gif" alt="Paul Newport is offline" border="0" />
<script type="text/javascript"> vbmenu_register("postmenu_76716", true); </script>
</div>
<div class="smallfont">Senior Member</div>
</td>
<td width="100%">&nbsp;</td>
<td valign="top" nowrap="nowrap">
<div class="smallfont">
<div>Join Date: Sep 2004</div>
<div>
						Posts: 576
					</div>
<div> </div>
</div>
</td>
</tr>
</table>
<!-- / user info -->
</td>
</tr>
<tr>
<td class="alt1" id="td_post_76716">
<!-- message, attachments, sig -->
<!-- icon and title -->
<div class="smallfont">
<img class="inlineimg" src="images/icons/icon1.gif" alt="Default" border="0" />
</div>
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<!-- / icon and title -->
<!-- message -->
<div id="post_message_76716">
<div style="margin:20px; margin-top:5px; ">
<div class="smallfont" style="margin-bottom:2px">Quote:</div>
<table cellpadding="6" cellspacing="0" border="0" width="100%">
<tr>
<td class="alt2" style="border:1px inset">
<div>
					Originally Posted by <strong>Keith Donald</strong>
</div>
<div style="font-style:italic">Could you elaborate what you mean by &quot;navigate around the subflow&quot;?<br />
<br />
What flow execution repository strategy are you using, and what version of SWF?<br />
<br />
Thanks!</div>
</td>
</tr>
</table>
</div><br />
OK, will do, was posting from home so had to do a general outline of the problem  rather than a detailed one.<br />
<br />
The problem happens with the default flow execution repository strategy and the continuation one as well.<br />
<br />
When I mean navigate around the sub-flow, I just mean, enter the sub-flow, go through it, and then exit it.<br />
<br />
The version of SWF I am using is spring-webflow-1.0-rc3.jar<br />
<br />
I can't post my entire log of what is happening as it is too big, but here are the relevant extracts:<br />
<br />
1) the sub-flow ends<br />
<br />
org.springframework.webflow.EndState - Entering state 'finish' of flow 'addressSearch'<br />
<br />
2) the screen that spawned the sub-flow is displayed<br />
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Code:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px inset;
		width: 800px;
		height: 34px;
		text-align: left;
		overflow: auto">org.springframework.webflow.execution.impl.FlowExecutionImpl - Paused to render [ApplicationView@2c9113e7 viewName = 'correspondenceDetails', model = map['org.springframework.validation.BindException.retailerInputCommand' -&gt; org.springframework.validation.BindException: BindException: 0 errors, 'org.springframework.validation.BindException.currentFormObject' -&gt; org.springframework.validation.BindException: BindException: 0 errors, 'currentFormObject' -&gt; net.targetgroup.sv2.retailerinput.RetailerInputCommand@5d193e4, 'retailerInputCommand' -&gt; net.targetgroup.sv2.retailerinput.RetailerInputCommand@5d193e4]] and wait for user input</pre>
</div>3) Hit button on &quot;correspondenceDetails&quot; view <br />
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Code:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px inset;
		width: 800px;
		height: 66px;
		text-align: left;
		overflow: auto"> &lt;input
			name=&quot;_eventId_submit&quot; type=&quot;submit&quot; value=&quot;Next&quot;&gt; &lt;input
			type=&quot;hidden&quot; name=&quot;_flowExecutionKey&quot; value=&quot;${flowExecutionKey}&quot;&gt;</pre>
</div>4) According to mapping should go to next page (registeredOfficeEntry in flow:<br />
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Code:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px inset;
		width: 800px;
		height: 162px;
		text-align: left;
		overflow: auto">&lt;view-state id=&quot;correspondenceDetails&quot; view=&quot;correspondenceDetails&quot;&gt;

		&lt;transition on=&quot;submit&quot; to=&quot;registeredOfficeEntry&quot;&gt;
			&lt;action bean=&quot;retailerInputFormAction&quot;
				method=&quot;bindAndValidate&quot;&gt;
				&lt;attribute name=&quot;validator&quot;
					value=&quot;validatorCorrespondenceDetails&quot; /&gt;
			&lt;/action&gt;
		&lt;/transition&gt;</pre>
</div>5) Page actually goes to a submit transition in the sub-flow:<br />
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Code:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px inset;
		width: 800px;
		height: 178px;
		text-align: left;
		overflow: auto">&lt;view-state id=&quot;addressList&quot; view=&quot;addressList&quot;&gt;


		&lt;transition on=&quot;submit&quot; to=&quot;selectAddress&quot;&gt;
			&lt;action bean=&quot;addressSearchAction&quot;
				method=&quot;bindAndValidate&quot;&gt;

			&lt;/action&gt;
		&lt;/transition&gt;
	&lt;/view-state&gt;</pre>
</div><div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Code:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px inset;
		width: 800px;
		height: 114px;
		text-align: left;
		overflow: auto">org.springframework.webflow.execution.impl.FlowExecutionImpl - Rehydrating
org.springframework.webflow.execution.impl.FlowExecutionImpl - Rehydrated
org.springframework.webflow.execution.impl.FlowExecutionImpl - Resuming this execution on user event 'submit'
org.springframework.webflow.execution.impl.RequestControlContextImpl - Signaling event 'submit' in state 'addressList' of flow 'addressSearch'
org.springframework.webflow.ActionExecutor - Executing [AnnotatedAction@1ed2939d targetAction = net.targetgroup.sv2.retailerinput.AddressSearchAction@287d93e2, attributes = map['method' -&gt; 'bindAndValidate']] in state 'addressList' of flow 'addressSearch'
net.targetgroup.sv2.retailerinput.AddressSearchAction - Action 'AddressSearchAction' beginning execution</pre>
</div>It almost looks as if it thinks the sub-flow is still active. My sub-flow is recursive, I wonder if it has just jumped out of the sub-flow rather than bubbling up to the top through the recursive calls. I pass in an address object when I call it from the main application, when it is called by itself it passes in two parameters on the request as one of the things it does it display a list of hrefs to call the flow again (it is displaying a list of addresses that you drill down through until you find a unique one).<br />
<br />
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Code:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px inset;
		width: 800px;
		height: 210px;
		text-align: left;
		overflow: auto">&lt;c:forEach items=&quot;${addressSearchCommand.validatorResult.addresses}&quot;
			var=&quot;address&quot; &gt;
		
			&lt;tr&gt;
				&lt;td&gt;&lt;a
					href=&quot;myApp.swf?_flowExecutionKey=${flowExecutionKey}&amp;_eventId=submit&amp;dps=${address.dps}&amp;postCode=${address.postCode}&quot;&gt;
				 Address: &lt;c:out value=&quot;${address}&quot;&gt;&lt;/c:out&gt;  &lt;/a&gt;&lt;/td&gt;
			&lt;/tr&gt;

		

		&lt;/c:forEach&gt;</pre>
</div><div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Code:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px inset;
		width: 800px;
		height: 498px;
		text-align: left;
		overflow: auto">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE flow PUBLIC &quot;-//SPRING//DTD WEBFLOW 1.0//EN&quot;
       &quot;http://www.springframework.org/dtd/spring-webflow-1.0.dtd&quot;&gt;
&lt;flow start-state=&quot;doSearch&quot;&gt;
	&lt;input-mapper&gt;
		&lt;mapping source=&quot;addressToPassIn&quot; target=&quot;flowScope.testAddress&quot; /&gt;
		&lt;mapping source=&quot;postCode&quot; target=&quot;flowScope.postCode&quot; /&gt;
		&lt;mapping source=&quot;dps&quot; target=&quot;flowScope.dps&quot; /&gt;

	&lt;/input-mapper&gt;


	&lt;action-state id=&quot;doSearch&quot;&gt;
		&lt;action bean=&quot;addressSearchAction&quot; method=&quot;getFormattedAddress&quot; /&gt;
		&lt;transition on=&quot;success&quot; to=&quot;addressListNeeded&quot; /&gt;
	&lt;/action-state&gt;


	&lt;decision-state id=&quot;addressListNeeded&quot;&gt;
		&lt;if test=&quot;${flowScope.addressSearchCommand.addressListNeeded}&quot;
			then=&quot;addressList&quot; else=&quot;finish&quot; /&gt;
	&lt;/decision-state&gt;

	&lt;view-state id=&quot;addressList&quot; view=&quot;addressList&quot;&gt;


		&lt;transition on=&quot;submit&quot; to=&quot;selectAddress&quot;&gt;
			&lt;action bean=&quot;addressSearchAction&quot;
				method=&quot;bindAndValidate&quot;&gt;

			&lt;/action&gt;
		&lt;/transition&gt;
	&lt;/view-state&gt;

	&lt;subflow-state id=&quot;selectAddress&quot; flow=&quot;addressSearch&quot;&gt;
		&lt;attribute-mapper&gt;
			&lt;input-mapper&gt;
				&lt;mapping source=&quot;${requestParameters.postCode}&quot;
					target=&quot;postCode&quot; /&gt;
				&lt;mapping source=&quot;${requestParameters.dps}&quot; target=&quot;dps&quot; /&gt;

			&lt;/input-mapper&gt;

			&lt;output-mapper&gt;
				&lt;mapping source=&quot;returnedAddress&quot;
					target=&quot;flowScope.addressSearchCommand.returnedAddress&quot; /&gt;

			&lt;/output-mapper&gt;
		&lt;/attribute-mapper&gt;
		&lt;transition on=&quot;finish&quot; to=&quot;doSearch&quot; /&gt;
	&lt;/subflow-state&gt;



	&lt;end-state id=&quot;finish&quot;&gt;


	&lt;/end-state&gt;
	&lt;output-mapper&gt;
		&lt;mapping source=&quot;${flowScope.testAddress}&quot; target=&quot;testOut&quot; /&gt;
		&lt;mapping source=&quot;${flowScope.addressSearchCommand.addressToPassBack}&quot;
					target=&quot;addressToPassBack&quot; /&gt;
		
	&lt;/output-mapper&gt;
	&lt;import resource=&quot;addressSearchContext.xml&quot; /&gt;


&lt;/flow&gt;</pre>
</div>
</div>
<!-- / message -->
<div style="margin-top: 10px" align="right">
<!-- controls -->
<a href="newreply.php?do=newreply&amp;p=76716" rel="nofollow"><img src="images/buttons/quote.gif" alt="Reply With Quote" border="0" /></a>
<a href="newreply.php?do=newreply&amp;p=76716" rel="nofollow" onclick="return false"><img src="images/buttons/multiquote_off.gif" alt="Multi-Quote This Message" border="0" id="mq_76716" /></a>
<a href="newreply.php?do=newreply&amp;p=76716" rel="nofollow" id="qr_76716" onclick="return false"><img src="images/buttons/quickreply.gif" alt="Quick reply to this message" border="0" /></a>
<!-- / controls -->
</div>
<!-- message, attachments, sig -->
</td>
</tr>
</table>
<!-- post 76716 popup menu -->
<div class="vbmenu_popup" id="postmenu_76716_menu" style="display:none;">
<table cellpadding="4" cellspacing="1" border="0">
<tr>
<td class="thead">Paul Newport</td>
</tr>
<tr><td class="vbmenu_option"><a href="member.php?u=7664">View Public Profile</a></td></tr>
<tr><td class="vbmenu_option"><a href="private.php?do=newpm&amp;u=7664" rel="nofollow">Send a private message to Paul Newport</a></td></tr>
<tr><td class="vbmenu_option"><a href="search.php?do=finduser&amp;u=7664" rel="nofollow">Find all posts by Paul Newport</a></td></tr>
<tr><td class="vbmenu_option"><a href="profile.php?do=addlist&amp;userlist=buddy&amp;u=7664">Add Paul Newport to Your Contacts</a></td></tr>
</table>
</div>
<!-- / post 76716 popup menu -->
</div>
</div>
</div>
</div>
<!-- / close content container -->
<!-- / post #76716 --><!-- post #76748 -->
<!-- open content container -->
<div align="center">
<div class="page" style="width:100%; text-align:left">
<div style="padding:0px 0px 0px 0px" align="left">
<div id="edit76748" style="padding:0px 0px 6px 0px">
<!-- this is not the last post shown on the page -->
<table class="tborder" id="post76748" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
			&nbsp;
			#<a href="showpost.php?p=76748&amp;postcount=4" target="new" rel="nofollow" id="postcount76748" name="4"><strong>4</strong></a> &nbsp;
			
			
			<a href="report.php?p=76748" rel="nofollow"><img class="inlineimg" src="images/buttons/report.gif" alt="Report Post" border="0" /></a> &nbsp;
			
			
		</div>
<div class="normal">
<!-- status icon and date -->
<a name="post76748"><img class="inlineimg" src="images/statusicon/post_old.gif" alt="Old" border="0" /></a>
			
				Sep 11th, 2006, 10:07 AM
			
			
			<!-- / status icon and date -->
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<!-- user info -->
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td class="alt2"><a href="member.php?u=6371"><img src="image.php?u=6371&amp;dateline=1288973702" width="56" height="77" alt="Keith Donald's Avatar" border="0" /></a></td>
<td nowrap="nowrap">
<div id="postmenu_76748">
<a class="bigusername" href="member.php?u=6371">Keith Donald</a>
<img class="inlineimg" src="images/statusicon/user_offline.gif" alt="Keith Donald is offline" border="0" />
<script type="text/javascript"> vbmenu_register("postmenu_76748", true); </script>
</div>
<div class="smallfont">Web App Development Lead</div>
<div class="smallfont">Spring Team</div>
</td>
<td width="100%">&nbsp;</td>
<td valign="top" nowrap="nowrap">
<div class="smallfont">
<div>Join Date: Aug 2004</div>
<div>Location: Melbourne, FL</div>
<div>
						Posts: 2,555
					</div>
<div> </div>
</div>
</td>
</tr>
</table>
<!-- / user info -->
</td>
</tr>
<tr>
<td class="alt1" id="td_post_76748">
<!-- message, attachments, sig -->
<!-- icon and title -->
<div class="smallfont">
<img class="inlineimg" src="images/icons/icon1.gif" alt="Default" border="0" />
</div>
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<!-- / icon and title -->
<!-- message -->
<div id="post_message_76748">
			
			Hi Paul,<br />
<br />
Hmmm... not sure why you're seeing the behavor you describe, so far anyway.  The Phonebook sample shows an example of a recursive flow that makes calls recursively, might be worth reviewing if you haven't already.<br />
<br />
To help us further investigate this, if you could submit a basic flow execution test that demonstrates the problem that would be excellent...  Phonebook has such an example test written (see SearchFlowExecutionTests).  Also, you might want to try against a latest 1.0 RC4 nightly build.<br />
<br />
Keith
		</div>
<!-- / message -->
<!-- sig -->
<div>
				__________________<br />
				Keith Donald<br />
Core Spring Development Team
			</div>
<!-- / sig -->
<!-- edit note -->
<div class="smallfont">
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<em>
					
						Last edited by Keith Donald; Sep 11th, 2006 at <span class="time">10:13 AM</span>.
					
					
				</em>
</div>
<!-- / edit note -->
<div style="margin-top: 10px" align="right">
<!-- controls -->
<a href="newreply.php?do=newreply&amp;p=76748" rel="nofollow"><img src="images/buttons/quote.gif" alt="Reply With Quote" border="0" /></a>
<a href="newreply.php?do=newreply&amp;p=76748" rel="nofollow" onclick="return false"><img src="images/buttons/multiquote_off.gif" alt="Multi-Quote This Message" border="0" id="mq_76748" /></a>
<a href="newreply.php?do=newreply&amp;p=76748" rel="nofollow" id="qr_76748" onclick="return false"><img src="images/buttons/quickreply.gif" alt="Quick reply to this message" border="0" /></a>
<!-- / controls -->
</div>
<!-- message, attachments, sig -->
</td>
</tr>
</table>
<!-- post 76748 popup menu -->
<div class="vbmenu_popup" id="postmenu_76748_menu" style="display:none;">
<table cellpadding="4" cellspacing="1" border="0">
<tr>
<td class="thead">Keith Donald</td>
</tr>
<tr><td class="vbmenu_option"><a href="member.php?u=6371">View Public Profile</a></td></tr>
<tr><td class="vbmenu_option"><a href="private.php?do=newpm&amp;u=6371" rel="nofollow">Send a private message to Keith Donald</a></td></tr>
<tr><td class="vbmenu_option"><a href="http://blog.springsource.com">Visit Keith Donald's homepage!</a></td></tr>
<tr><td class="vbmenu_option"><a href="search.php?do=finduser&amp;u=6371" rel="nofollow">Find all posts by Keith Donald</a></td></tr>
<tr><td class="vbmenu_option"><a href="profile.php?do=addlist&amp;userlist=buddy&amp;u=6371">Add Keith Donald to Your Contacts</a></td></tr>
</table>
</div>
<!-- / post 76748 popup menu -->
</div>
</div>
</div>
</div>
<!-- / close content container -->
<!-- / post #76748 --><!-- post #76771 -->
<!-- open content container -->
<div align="center">
<div class="page" style="width:100%; text-align:left">
<div style="padding:0px 0px 0px 0px" align="left">
<div id="edit76771" style="padding:0px 0px 6px 0px">
<!-- this is not the last post shown on the page -->
<table class="tborder" id="post76771" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
			&nbsp;
			#<a href="showpost.php?p=76771&amp;postcount=5" target="new" rel="nofollow" id="postcount76771" name="5"><strong>5</strong></a> &nbsp;
			
			
			<a href="report.php?p=76771" rel="nofollow"><img class="inlineimg" src="images/buttons/report.gif" alt="Report Post" border="0" /></a> &nbsp;
			
			
		</div>
<div class="normal">
<!-- status icon and date -->
<a name="post76771"><img class="inlineimg" src="images/statusicon/post_old.gif" alt="Old" border="0" /></a>
			
				Sep 11th, 2006, 11:54 AM
			
			
			<!-- / status icon and date -->
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<!-- user info -->
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td nowrap="nowrap">
<div id="postmenu_76771">
<a class="bigusername" href="member.php?u=7664">Paul Newport</a>
<img class="inlineimg" src="images/statusicon/user_offline.gif" alt="Paul Newport is offline" border="0" />
<script type="text/javascript"> vbmenu_register("postmenu_76771", true); </script>
</div>
<div class="smallfont">Senior Member</div>
</td>
<td width="100%">&nbsp;</td>
<td valign="top" nowrap="nowrap">
<div class="smallfont">
<div>Join Date: Sep 2004</div>
<div>
						Posts: 576
					</div>
<div> </div>
</div>
</td>
</tr>
</table>
<!-- / user info -->
</td>
</tr>
<tr>
<td class="alt1" id="td_post_76771">
<!-- message, attachments, sig -->
<!-- icon and title -->
<div class="smallfont">
<img class="inlineimg" src="images/icons/icon1.gif" alt="Default" border="0" />
</div>
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<!-- / icon and title -->
<!-- message -->
<div id="post_message_76771">
			
			OK thanks for this Keith. My app is fairly heavily based on the phone book example but unfortuantely the address search part of it ends up calling some native code, so will have to do a bit of tweaking to get a stand alone test sorted out, which will probably show me the problem anyway !
		</div>
<!-- / message -->
<div style="margin-top: 10px" align="right">
<!-- controls -->
<a href="newreply.php?do=newreply&amp;p=76771" rel="nofollow"><img src="images/buttons/quote.gif" alt="Reply With Quote" border="0" /></a>
<a href="newreply.php?do=newreply&amp;p=76771" rel="nofollow" onclick="return false"><img src="images/buttons/multiquote_off.gif" alt="Multi-Quote This Message" border="0" id="mq_76771" /></a>
<a href="newreply.php?do=newreply&amp;p=76771" rel="nofollow" id="qr_76771" onclick="return false"><img src="images/buttons/quickreply.gif" alt="Quick reply to this message" border="0" /></a>
<!-- / controls -->
</div>
<!-- message, attachments, sig -->
</td>
</tr>
</table>
<!-- post 76771 popup menu -->
<div class="vbmenu_popup" id="postmenu_76771_menu" style="display:none;">
<table cellpadding="4" cellspacing="1" border="0">
<tr>
<td class="thead">Paul Newport</td>
</tr>
<tr><td class="vbmenu_option"><a href="member.php?u=7664">View Public Profile</a></td></tr>
<tr><td class="vbmenu_option"><a href="private.php?do=newpm&amp;u=7664" rel="nofollow">Send a private message to Paul Newport</a></td></tr>
<tr><td class="vbmenu_option"><a href="search.php?do=finduser&amp;u=7664" rel="nofollow">Find all posts by Paul Newport</a></td></tr>
<tr><td class="vbmenu_option"><a href="profile.php?do=addlist&amp;userlist=buddy&amp;u=7664">Add Paul Newport to Your Contacts</a></td></tr>
</table>
</div>
<!-- / post 76771 popup menu -->
</div>
</div>
</div>
</div>
<!-- / close content container -->
<!-- / post #76771 --><!-- post #77041 -->
<!-- open content container -->
<div align="center">
<div class="page" style="width:100%; text-align:left">
<div style="padding:0px 0px 0px 0px" align="left">
<div id="edit77041" style="padding:0px 0px 6px 0px">
<!-- this is not the last post shown on the page -->
<table class="tborder" id="post77041" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
			&nbsp;
			#<a href="showpost.php?p=77041&amp;postcount=6" target="new" rel="nofollow" id="postcount77041" name="6"><strong>6</strong></a> &nbsp;
			
			
			<a href="report.php?p=77041" rel="nofollow"><img class="inlineimg" src="images/buttons/report.gif" alt="Report Post" border="0" /></a> &nbsp;
			
			
		</div>
<div class="normal">
<!-- status icon and date -->
<a name="post77041"><img class="inlineimg" src="images/statusicon/post_old.gif" alt="Old" border="0" /></a>
			
				Sep 13th, 2006, 06:16 AM
			
			
			<!-- / status icon and date -->
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<!-- user info -->
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td nowrap="nowrap">
<div id="postmenu_77041">
<a class="bigusername" href="member.php?u=7664">Paul Newport</a>
<img class="inlineimg" src="images/statusicon/user_offline.gif" alt="Paul Newport is offline" border="0" />
<script type="text/javascript"> vbmenu_register("postmenu_77041", true); </script>
</div>
<div class="smallfont">Senior Member</div>
</td>
<td width="100%">&nbsp;</td>
<td valign="top" nowrap="nowrap">
<div class="smallfont">
<div>Join Date: Sep 2004</div>
<div>
						Posts: 576
					</div>
<div> </div>
</div>
</td>
</tr>
</table>
<!-- / user info -->
</td>
</tr>
<tr>
<td class="alt1" id="td_post_77041">
<!-- message, attachments, sig -->
<!-- icon and title -->
<div class="smallfont">
<img class="inlineimg" src="images/icons/icon1.gif" alt="Default" border="0" />
</div>
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<!-- / icon and title -->
<!-- message -->
<div id="post_message_77041">
			
			Upgrading to spring-webflow-1.0-rc4-20060911223007.jar made no difference here.<br />
<br />
I am now writing a test extending AbstractExternalizedFlowExecutionTests. I want to use this so that I can explicitly test my real parent flow (not a fake one just there for testing), and that parent flow has call to service beans that need to be loaded from external contexts.<br />
<br />
What I want to to is jump to the part of the parent flow that is about to call the sub-flow, and then call the sub-flow, but I can't work out what I have to do to implement the abstract method createFlowBuilder.<br />
<br />
	protected FlowBuilder createFlowBuilder(Resource arg0, FlowServiceLocator arg1) {<br />
		// TODO What do I do here ?<br />
		return null;<br />
	}<br />
<br />
Any pointers at all ?
		</div>
<!-- / message -->
<div style="margin-top: 10px" align="right">
<!-- controls -->
<a href="newreply.php?do=newreply&amp;p=77041" rel="nofollow"><img src="images/buttons/quote.gif" alt="Reply With Quote" border="0" /></a>
<a href="newreply.php?do=newreply&amp;p=77041" rel="nofollow" onclick="return false"><img src="images/buttons/multiquote_off.gif" alt="Multi-Quote This Message" border="0" id="mq_77041" /></a>
<a href="newreply.php?do=newreply&amp;p=77041" rel="nofollow" id="qr_77041" onclick="return false"><img src="images/buttons/quickreply.gif" alt="Quick reply to this message" border="0" /></a>
<!-- / controls -->
</div>
<!-- message, attachments, sig -->
</td>
</tr>
</table>
<!-- post 77041 popup menu -->
<div class="vbmenu_popup" id="postmenu_77041_menu" style="display:none;">
<table cellpadding="4" cellspacing="1" border="0">
<tr>
<td class="thead">Paul Newport</td>
</tr>
<tr><td class="vbmenu_option"><a href="member.php?u=7664">View Public Profile</a></td></tr>
<tr><td class="vbmenu_option"><a href="private.php?do=newpm&amp;u=7664" rel="nofollow">Send a private message to Paul Newport</a></td></tr>
<tr><td class="vbmenu_option"><a href="search.php?do=finduser&amp;u=7664" rel="nofollow">Find all posts by Paul Newport</a></td></tr>
<tr><td class="vbmenu_option"><a href="profile.php?do=addlist&amp;userlist=buddy&amp;u=7664">Add Paul Newport to Your Contacts</a></td></tr>
</table>
</div>
<!-- / post 77041 popup menu -->
</div>
</div>
</div>
</div>
<!-- / close content container -->
<!-- / post #77041 --><!-- post #77062 -->
<!-- open content container -->
<div align="center">
<div class="page" style="width:100%; text-align:left">
<div style="padding:0px 0px 0px 0px" align="left">
<div id="edit77062" style="padding:0px 0px 6px 0px">
<!-- this is not the last post shown on the page -->
<table class="tborder" id="post77062" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
			&nbsp;
			#<a href="showpost.php?p=77062&amp;postcount=7" target="new" rel="nofollow" id="postcount77062" name="7"><strong>7</strong></a> &nbsp;
			
			
			<a href="report.php?p=77062" rel="nofollow"><img class="inlineimg" src="images/buttons/report.gif" alt="Report Post" border="0" /></a> &nbsp;
			
			
		</div>
<div class="normal">
<!-- status icon and date -->
<a name="post77062"><img class="inlineimg" src="images/statusicon/post_old.gif" alt="Old" border="0" /></a>
			
				Sep 13th, 2006, 08:50 AM
			
			
			<!-- / status icon and date -->
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<!-- user info -->
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td class="alt2"><a href="member.php?u=6371"><img src="image.php?u=6371&amp;dateline=1288973702" width="56" height="77" alt="Keith Donald's Avatar" border="0" /></a></td>
<td nowrap="nowrap">
<div id="postmenu_77062">
<a class="bigusername" href="member.php?u=6371">Keith Donald</a>
<img class="inlineimg" src="images/statusicon/user_offline.gif" alt="Keith Donald is offline" border="0" />
<script type="text/javascript"> vbmenu_register("postmenu_77062", true); </script>
</div>
<div class="smallfont">Web App Development Lead</div>
<div class="smallfont">Spring Team</div>
</td>
<td width="100%">&nbsp;</td>
<td valign="top" nowrap="nowrap">
<div class="smallfont">
<div>Join Date: Aug 2004</div>
<div>Location: Melbourne, FL</div>
<div>
						Posts: 2,555
					</div>
<div> </div>
</div>
</td>
</tr>
</table>
<!-- / user info -->
</td>
</tr>
<tr>
<td class="alt1" id="td_post_77062">
<!-- message, attachments, sig -->
<!-- icon and title -->
<div class="smallfont">
<img class="inlineimg" src="images/icons/icon1.gif" alt="Default" border="0" />
</div>
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<!-- / icon and title -->
<!-- message -->
<div id="post_message_77062">
			
			Paul,<br />
<br />
createFlowBuilder is not intended to be overrided.  I've just now made it final for 1.0 rc4 to indicate this.<br />
<br />
What I would recommend is overriding registerMockServices or createFlowServiceLocator.<br />
<br />
If you look at the default impl of &quot;createFlowServiceLocator&quot; you'll see it creates a MockFlowServiceLocator and gives your subclass a registerMockServices callback where you may register mock beans and other flow definitions used as subflows.  You can override that and register stubs or mocks for your middle-tier beans, and &quot;real&quot; references to your other flow definitions like this:<br />
<br />
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Code:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px inset;
		width: 800px;
		height: 178px;
		text-align: left;
		overflow: auto">protected void registerMockServices(MockFlowServiceLocator locator) {
    locator.registerBean(&quot;myBean&quot;, new MyStubBean());
    
    FlowDefinitionResource resource =
        createFlowDefinitionResource(&quot;/file/path/to/my-subflow.xml&quot;);
    Flow subflow = createFlow(resource, locator);
    locator.registerSubflow(subflow);

    // repeat for each subflow
}</pre>
</div>Alternatively, if you want to test against a real middle tier, you could subclass createFlowServiceLocator and return a DefaultFlowServiceLocator, passing it a populated FlowRegistry containing your flow definitions and a BeanFactory containing any references to real backing beans such as middle-tier services.<br />
<br />
Something like this:<br />
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Code:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px inset;
		width: 800px;
		height: 226px;
		text-align: left;
		overflow: auto">
protected FlowServiceLocator createFlowServiceLocator() {
    ClassPathXmlApplicationContext context =
        new ClassPathXmlApplicationContext(&quot;/services-config.xml&quot;);
    FlowDefinitionRegistry registry = new FlowDefinitionRegistryImpl();
    DefaultFlowService locator =
        new DefaultFlowServiceLocator(registry, context);
    XmlFlowRegistrar registrar = new XmlFlowRegistrar(locator);
    registrar.addResource(createFlowDefinitionResource(&quot;dir/flow.xml&quot;);
    registrar.addResource(createFlowDefintionResource(&quot;dir/subflow.xml&quot;);
    registrar.registerFlowDefinitions(registry);
    return locator;
}</pre>
</div> Keith
		</div>
<!-- / message -->
<!-- sig -->
<div>
				__________________<br />
				Keith Donald<br />
Core Spring Development Team
			</div>
<!-- / sig -->
<!-- edit note -->
<div class="smallfont">
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<em>
					
						Last edited by Keith Donald; Sep 13th, 2006 at <span class="time">08:55 AM</span>.
					
					
				</em>
</div>
<!-- / edit note -->
<div style="margin-top: 10px" align="right">
<!-- controls -->
<a href="newreply.php?do=newreply&amp;p=77062" rel="nofollow"><img src="images/buttons/quote.gif" alt="Reply With Quote" border="0" /></a>
<a href="newreply.php?do=newreply&amp;p=77062" rel="nofollow" onclick="return false"><img src="images/buttons/multiquote_off.gif" alt="Multi-Quote This Message" border="0" id="mq_77062" /></a>
<a href="newreply.php?do=newreply&amp;p=77062" rel="nofollow" id="qr_77062" onclick="return false"><img src="images/buttons/quickreply.gif" alt="Quick reply to this message" border="0" /></a>
<!-- / controls -->
</div>
<!-- message, attachments, sig -->
</td>
</tr>
</table>
<!-- post 77062 popup menu -->
<div class="vbmenu_popup" id="postmenu_77062_menu" style="display:none;">
<table cellpadding="4" cellspacing="1" border="0">
<tr>
<td class="thead">Keith Donald</td>
</tr>
<tr><td class="vbmenu_option"><a href="member.php?u=6371">View Public Profile</a></td></tr>
<tr><td class="vbmenu_option"><a href="private.php?do=newpm&amp;u=6371" rel="nofollow">Send a private message to Keith Donald</a></td></tr>
<tr><td class="vbmenu_option"><a href="http://blog.springsource.com">Visit Keith Donald's homepage!</a></td></tr>
<tr><td class="vbmenu_option"><a href="search.php?do=finduser&amp;u=6371" rel="nofollow">Find all posts by Keith Donald</a></td></tr>
<tr><td class="vbmenu_option"><a href="profile.php?do=addlist&amp;userlist=buddy&amp;u=6371">Add Keith Donald to Your Contacts</a></td></tr>
</table>
</div>
<!-- / post 77062 popup menu -->
</div>
</div>
</div>
</div>
<!-- / close content container -->
<!-- / post #77062 --><!-- post #77098 -->
<!-- open content container -->
<div align="center">
<div class="page" style="width:100%; text-align:left">
<div style="padding:0px 0px 0px 0px" align="left">
<div id="edit77098" style="padding:0px 0px 6px 0px">
<!-- this is not the last post shown on the page -->
<table class="tborder" id="post77098" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
			&nbsp;
			#<a href="showpost.php?p=77098&amp;postcount=8" target="new" rel="nofollow" id="postcount77098" name="8"><strong>8</strong></a> &nbsp;
			
			
			<a href="report.php?p=77098" rel="nofollow"><img class="inlineimg" src="images/buttons/report.gif" alt="Report Post" border="0" /></a> &nbsp;
			
			
		</div>
<div class="normal">
<!-- status icon and date -->
<a name="post77098"><img class="inlineimg" src="images/statusicon/post_old.gif" alt="Old" border="0" /></a>
			
				Sep 13th, 2006, 11:55 AM
			
			
			<!-- / status icon and date -->
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<!-- user info -->
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td nowrap="nowrap">
<div id="postmenu_77098">
<a class="bigusername" href="member.php?u=7664">Paul Newport</a>
<img class="inlineimg" src="images/statusicon/user_offline.gif" alt="Paul Newport is offline" border="0" />
<script type="text/javascript"> vbmenu_register("postmenu_77098", true); </script>
</div>
<div class="smallfont">Senior Member</div>
</td>
<td width="100%">&nbsp;</td>
<td valign="top" nowrap="nowrap">
<div class="smallfont">
<div>Join Date: Sep 2004</div>
<div>
						Posts: 576
					</div>
<div> </div>
</div>
</td>
</tr>
</table>
<!-- / user info -->
</td>
</tr>
<tr>
<td class="alt1" id="td_post_77098">
<!-- message, attachments, sig -->
<!-- icon and title -->
<div class="smallfont">
<img class="inlineimg" src="images/icons/icon1.gif" alt="Default" border="0" />
</div>
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<!-- / icon and title -->
<!-- message -->
<div id="post_message_77098">
			
			Thanks again - I was using AbstractExternalizedFlowExecutionTests where AbstractExternalizedFlowExecutionTests is actually abstract, so I assumed I had to override it, but I guess I was trying to use the wrong class altogether.<br />
<br />
Can I double check the class I am now right in extending AbstractXmlFlowExecutionTests for testing both mock and middle tiers ?<br />
<br />
By the way I noticed a large amount of refactoring between RC3 and 4, is this going to calm down a bit for the main release ?
		</div>
<!-- / message -->
<div style="margin-top: 10px" align="right">
<!-- controls -->
<a href="newreply.php?do=newreply&amp;p=77098" rel="nofollow"><img src="images/buttons/quote.gif" alt="Reply With Quote" border="0" /></a>
<a href="newreply.php?do=newreply&amp;p=77098" rel="nofollow" onclick="return false"><img src="images/buttons/multiquote_off.gif" alt="Multi-Quote This Message" border="0" id="mq_77098" /></a>
<a href="newreply.php?do=newreply&amp;p=77098" rel="nofollow" id="qr_77098" onclick="return false"><img src="images/buttons/quickreply.gif" alt="Quick reply to this message" border="0" /></a>
<!-- / controls -->
</div>
<!-- message, attachments, sig -->
</td>
</tr>
</table>
<!-- post 77098 popup menu -->
<div class="vbmenu_popup" id="postmenu_77098_menu" style="display:none;">
<table cellpadding="4" cellspacing="1" border="0">
<tr>
<td class="thead">Paul Newport</td>
</tr>
<tr><td class="vbmenu_option"><a href="member.php?u=7664">View Public Profile</a></td></tr>
<tr><td class="vbmenu_option"><a href="private.php?do=newpm&amp;u=7664" rel="nofollow">Send a private message to Paul Newport</a></td></tr>
<tr><td class="vbmenu_option"><a href="search.php?do=finduser&amp;u=7664" rel="nofollow">Find all posts by Paul Newport</a></td></tr>
<tr><td class="vbmenu_option"><a href="profile.php?do=addlist&amp;userlist=buddy&amp;u=7664">Add Paul Newport to Your Contacts</a></td></tr>
</table>
</div>
<!-- / post 77098 popup menu -->
</div>
</div>
</div>
</div>
<!-- / close content container -->
<!-- / post #77098 --><!-- post #77121 -->
<!-- open content container -->
<div align="center">
<div class="page" style="width:100%; text-align:left">
<div style="padding:0px 0px 0px 0px" align="left">
<div id="edit77121" style="padding:0px 0px 6px 0px">
<!-- this is not the last post shown on the page -->
<table class="tborder" id="post77121" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
			&nbsp;
			#<a href="showpost.php?p=77121&amp;postcount=9" target="new" rel="nofollow" id="postcount77121" name="9"><strong>9</strong></a> &nbsp;
			
			
			<a href="report.php?p=77121" rel="nofollow"><img class="inlineimg" src="images/buttons/report.gif" alt="Report Post" border="0" /></a> &nbsp;
			
			
		</div>
<div class="normal">
<!-- status icon and date -->
<a name="post77121"><img class="inlineimg" src="images/statusicon/post_old.gif" alt="Old" border="0" /></a>
			
				Sep 13th, 2006, 01:54 PM
			
			
			<!-- / status icon and date -->
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<!-- user info -->
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td class="alt2"><a href="member.php?u=6371"><img src="image.php?u=6371&amp;dateline=1288973702" width="56" height="77" alt="Keith Donald's Avatar" border="0" /></a></td>
<td nowrap="nowrap">
<div id="postmenu_77121">
<a class="bigusername" href="member.php?u=6371">Keith Donald</a>
<img class="inlineimg" src="images/statusicon/user_offline.gif" alt="Keith Donald is offline" border="0" />
<script type="text/javascript"> vbmenu_register("postmenu_77121", true); </script>
</div>
<div class="smallfont">Web App Development Lead</div>
<div class="smallfont">Spring Team</div>
</td>
<td width="100%">&nbsp;</td>
<td valign="top" nowrap="nowrap">
<div class="smallfont">
<div>Join Date: Aug 2004</div>
<div>Location: Melbourne, FL</div>
<div>
						Posts: 2,555
					</div>
<div> </div>
</div>
</td>
</tr>
</table>
<!-- / user info -->
</td>
</tr>
<tr>
<td class="alt1" id="td_post_77121">
<!-- message, attachments, sig -->
<!-- icon and title -->
<div class="smallfont">
<img class="inlineimg" src="images/icons/icon1.gif" alt="Default" border="0" />
</div>
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<!-- / icon and title -->
<!-- message -->
<div id="post_message_77121">
			
			Yes, extend AbstractXmlFlowExecutionTests.<br />
<br />
Indeed, there are new features and some changed in 1.0 RC4 (such as the move away from DTD to XSD), hence the important emphasis on updated documentation, a diff summary/migration guide, and our careful overall attention towards this release.<br />
<br />
Once we're at 1.0 final we must preserve backwards compatability, hence the attention at this critical time.  Once we hit 1.0 there is no going back.  We expect to go 1.0 final immediately following Spring 2.0 final, currently scheduled for September 26th.
		</div>
<!-- / message -->
<!-- sig -->
<div>
				__________________<br />
				Keith Donald<br />
Core Spring Development Team
			</div>
<!-- / sig -->
<!-- edit note -->
<div class="smallfont">
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<em>
					
						Last edited by Keith Donald; Sep 13th, 2006 at <span class="time">02:29 PM</span>.
					
					
				</em>
</div>
<!-- / edit note -->
<div style="margin-top: 10px" align="right">
<!-- controls -->
<a href="newreply.php?do=newreply&amp;p=77121" rel="nofollow"><img src="images/buttons/quote.gif" alt="Reply With Quote" border="0" /></a>
<a href="newreply.php?do=newreply&amp;p=77121" rel="nofollow" onclick="return false"><img src="images/buttons/multiquote_off.gif" alt="Multi-Quote This Message" border="0" id="mq_77121" /></a>
<a href="newreply.php?do=newreply&amp;p=77121" rel="nofollow" id="qr_77121" onclick="return false"><img src="images/buttons/quickreply.gif" alt="Quick reply to this message" border="0" /></a>
<!-- / controls -->
</div>
<!-- message, attachments, sig -->
</td>
</tr>
</table>
<!-- post 77121 popup menu -->
<div class="vbmenu_popup" id="postmenu_77121_menu" style="display:none;">
<table cellpadding="4" cellspacing="1" border="0">
<tr>
<td class="thead">Keith Donald</td>
</tr>
<tr><td class="vbmenu_option"><a href="member.php?u=6371">View Public Profile</a></td></tr>
<tr><td class="vbmenu_option"><a href="private.php?do=newpm&amp;u=6371" rel="nofollow">Send a private message to Keith Donald</a></td></tr>
<tr><td class="vbmenu_option"><a href="http://blog.springsource.com">Visit Keith Donald's homepage!</a></td></tr>
<tr><td class="vbmenu_option"><a href="search.php?do=finduser&amp;u=6371" rel="nofollow">Find all posts by Keith Donald</a></td></tr>
<tr><td class="vbmenu_option"><a href="profile.php?do=addlist&amp;userlist=buddy&amp;u=6371">Add Keith Donald to Your Contacts</a></td></tr>
</table>
</div>
<!-- / post 77121 popup menu -->
</div>
</div>
</div>
</div>
<!-- / close content container -->
<!-- / post #77121 --><!-- post #77220 -->
<!-- open content container -->
<div align="center">
<div class="page" style="width:100%; text-align:left">
<div style="padding:0px 0px 0px 0px" align="left">
<div id="edit77220" style="padding:0px 0px 6px 0px">
<table class="tborder" id="post77220" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
			&nbsp;
			#<a href="showpost.php?p=77220&amp;postcount=10" target="new" rel="nofollow" id="postcount77220" name="10"><strong>10</strong></a> &nbsp;
			
			
			<a href="report.php?p=77220" rel="nofollow"><img class="inlineimg" src="images/buttons/report.gif" alt="Report Post" border="0" /></a> &nbsp;
			
			
		</div>
<div class="normal">
<!-- status icon and date -->
<a name="post77220"><img class="inlineimg" src="images/statusicon/post_old.gif" alt="Old" border="0" /></a>
			
				Sep 14th, 2006, 06:11 AM
			
			
			<!-- / status icon and date -->
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<!-- user info -->
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td nowrap="nowrap">
<div id="postmenu_77220">
<a class="bigusername" href="member.php?u=7664">Paul Newport</a>
<img class="inlineimg" src="images/statusicon/user_offline.gif" alt="Paul Newport is offline" border="0" />
<script type="text/javascript"> vbmenu_register("postmenu_77220", true); </script>
</div>
<div class="smallfont">Senior Member</div>
</td>
<td width="100%">&nbsp;</td>
<td valign="top" nowrap="nowrap">
<div class="smallfont">
<div>Join Date: Sep 2004</div>
<div>
						Posts: 576
					</div>
<div> </div>
</div>
</td>
</tr>
</table>
<!-- / user info -->
</td>
</tr>
<tr>
<td class="alt1" id="td_post_77220">
<!-- message, attachments, sig -->
<!-- icon and title -->
<div class="smallfont">
<img class="inlineimg" src="images/icons/icon1.gif" alt="Default" border="0" />
</div>
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<!-- / icon and title -->
<!-- message -->
<div id="post_message_77220">
			
			Thanks for the reply.<br />
<br />
I still have not got around to getting a working test case, as had a bit of a pause whilst upgrading to RC4, and Spring 2 as well.<br />
<br />
The problem still exists in RC4.<br />
<br />
What appears to be happening is as follows:<br />
<br />
You call the sub-flow by clicking a search button on a JSP (lets call this parent.jsp)<br />
<br />
The sub-flow does it stuff and finishes, returning to parent.jsp<br />
<br />
If you click a button on parent.jsp, any button at all in fact, it simply does not execute the transition at all, but jumps right back into the sub-flow:<br />
<br />
this button pressed: <br />
<br />
&lt;input name=&quot;_eventId_addressSearch&quot; value=&quot;Search&quot; type=&quot;submit&quot;&gt;<br />
<br />
this transition expected:<br />
<br />
&lt;transition on=&quot;addressSearch&quot; to=&quot;directorAddressSearch&quot;&gt;<br />
<br />
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Code:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px inset;
		width: 800px;
		height: 162px;
		text-align: left;
		overflow: auto">k.web.servlet.DispatcherServlet - DispatcherServlet with name 'spring' received request for [/RetailerInputWeb/app/myApp.swf]
org.springframework.web.servlet.DispatcherServlet - Bound request context to thread: com.ibm.ws.webcontainer.srt.SRTServletRequest@3e535658
org.springframework.web.servlet.DispatcherServlet - Testing handler map [org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping@2ce7d66d] in DispatcherServlet with name 'spring'
org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping - Looking up handler for [/myApp.swf]
org.springframework.web.servlet.DispatcherServlet - Testing handler adapter [org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter@2a7bd66a]
org.springframework.web.servlet.DispatcherServlet - Testing handler adapter [org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter@42b7166a]
org.springframework.webflow.executor.support.FlowRequestHandler - Request initiated by [ServletExternalContext@4c5a166b requestParameterMap = map['_eventId' -&gt; 'submitAddressSearchSubFlow', 'headOffice.registeredOfficeAddress.registeredNumber' -&gt; '', '_flowExecutionKey' -&gt; array&lt;String&gt;['_cF728EBE2-E870-A5AD-59B5-57D457934EE8_kE6C5E516-4424-D721-91CD-9114DD99F700', '_cF728EBE2-E870-A5AD-59B5-57D457934EE8_k45FA78E9-7417-5DEE-A723-C6ED52731F1D'], 'headOffice.contactDetails.address.street' -&gt; '                                            ', 'headOffice.contactDetails.emailAddress' -&gt; '', 'postCode' -&gt; 'BS20 7DP', 'headOffice.contactDetails.address.townOrCity' -&gt; '                   ', 'correspondenceRequired' -&gt; 'false', 'headOffice.contactDetails.address.postCode' -&gt; 'br2 9jy', 'headOffice.contactDetails.telephoneNumbers[1].number' -&gt; '', 'registeredOfficeRequired' -&gt; 'false', 'headOffice.contactDetails.telephoneNumbers[0].number' -&gt; '', 'headOffice.priority' -&gt; '', 'headOffice.contactDetails.address.houseName' -&gt; '                                                  ', 'headOffice.contactDetails.address.district' -&gt; '', 'headOffice.contactDetails.address.houseNumber' -&gt; ' ', 'headOffice.registeredOfficeAddress.vatNumber' -&gt; '', '_eventId_addressSearch' -&gt; 'Search', 'dps' -&gt; '1T']]
org.springframework.webflow.engine.impl.FlowExecutionImpl - Resuming this execution on user event 'submitAddressSearchSubFlow'
org.springframework.webflow.engine.impl.RequestControlContextImpl - Signaling event 'submitAddressSearchSubFlow' in state 'addressList' of flow 'addressSearch'</pre>
</div>There seems to be a few wrong things here:<br />
<br />
First of all the request parameters passed in are all wrong, I can see some old request parameters that are used internally when the sub-flow calls itself, but these are &quot;stale&quot; and not relevant at all to the current request<br />
<br />
The sub-flow that is called has already finished and I would have thought should be &quot;dead&quot; and not capable of doing this &quot;Resuming this execution on user event ''submitAddressSearchSubFlow''&quot;<br />
<br />
The user event is not &quot;submit&quot;, but &quot;_eventId_addressSearch&quot;<br />
<br />
It almost looks as if the request and sub-flow both are still alive when they should not be (zombies ????!) and as such web flow ignores what is being submitted from parent.jsp and just carries on with what it thinks is an on-goin g subflow. I say this because if you look at this<br />
<br />
 map['_eventId' -&gt; 'submitAddressSearchSubFlow'<br />
<br />
I can see that the event_id is wrong (it's an event id from the subflow) , and therefore I guess that the _flowExecutionKey is similarly wrong (old).
		</div>
<!-- / message -->
<div style="margin-top: 10px" align="right">
<!-- controls -->
<a href="newreply.php?do=newreply&amp;p=77220" rel="nofollow"><img src="images/buttons/quote.gif" alt="Reply With Quote" border="0" /></a>
<a href="newreply.php?do=newreply&amp;p=77220" rel="nofollow" onclick="return false"><img src="images/buttons/multiquote_off.gif" alt="Multi-Quote This Message" border="0" id="mq_77220" /></a>
<a href="newreply.php?do=newreply&amp;p=77220" rel="nofollow" id="qr_77220" onclick="return false"><img src="images/buttons/quickreply.gif" alt="Quick reply to this message" border="0" /></a>
<!-- / controls -->
</div>
<!-- message, attachments, sig -->
</td>
</tr>
</table>
<!-- post 77220 popup menu -->
<div class="vbmenu_popup" id="postmenu_77220_menu" style="display:none;">
<table cellpadding="4" cellspacing="1" border="0">
<tr>
<td class="thead">Paul Newport</td>
</tr>
<tr><td class="vbmenu_option"><a href="member.php?u=7664">View Public Profile</a></td></tr>
<tr><td class="vbmenu_option"><a href="private.php?do=newpm&amp;u=7664" rel="nofollow">Send a private message to Paul Newport</a></td></tr>
<tr><td class="vbmenu_option"><a href="search.php?do=finduser&amp;u=7664" rel="nofollow">Find all posts by Paul Newport</a></td></tr>
<tr><td class="vbmenu_option"><a href="profile.php?do=addlist&amp;userlist=buddy&amp;u=7664">Add Paul Newport to Your Contacts</a></td></tr>
</table>
</div>
<!-- / post 77220 popup menu -->
</div>
</div>
</div>
</div>
<!-- / close content container -->
<!-- / post #77220 --><div id="lastpost"></div></div><div id="posts"><!-- post #77225 -->
<!-- open content container -->
<div align="center">
<div class="page" style="width:100%; text-align:left">
<div style="padding:0px 0px 0px 0px" align="left">
<div id="edit77225" style="padding:0px 0px 6px 0px">
<!-- this is not the last post shown on the page -->
<table class="tborder" id="post77225" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
			&nbsp;
			#<a href="showpost.php?p=77225&amp;postcount=11" target="new" rel="nofollow" id="postcount77225" name="11"><strong>11</strong></a> &nbsp;
			
			
			<a href="report.php?p=77225" rel="nofollow"><img class="inlineimg" src="images/buttons/report.gif" alt="Report Post" border="0" /></a> &nbsp;
			
			
		</div>
<div class="normal">
<!-- status icon and date -->
<a name="post77225"><img class="inlineimg" src="images/statusicon/post_old.gif" alt="Old" border="0" /></a>
			
				Sep 14th, 2006, 07:39 AM
			
			
			<!-- / status icon and date -->
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<!-- user info -->
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td class="alt2"><a href="member.php?u=6371"><img src="image.php?u=6371&amp;dateline=1288973702" width="56" height="77" alt="Keith Donald's Avatar" border="0" /></a></td>
<td nowrap="nowrap">
<div id="postmenu_77225">
<a class="bigusername" href="member.php?u=6371">Keith Donald</a>
<img class="inlineimg" src="images/statusicon/user_offline.gif" alt="Keith Donald is offline" border="0" />
<script type="text/javascript"> vbmenu_register("postmenu_77225", true); </script>
</div>
<div class="smallfont">Web App Development Lead</div>
<div class="smallfont">Spring Team</div>
</td>
<td width="100%">&nbsp;</td>
<td valign="top" nowrap="nowrap">
<div class="smallfont">
<div>Join Date: Aug 2004</div>
<div>Location: Melbourne, FL</div>
<div>
						Posts: 2,555
					</div>
<div> </div>
</div>
</td>
</tr>
</table>
<!-- / user info -->
</td>
</tr>
<tr>
<td class="alt1" id="td_post_77225">
<!-- message, attachments, sig -->
<!-- icon and title -->
<div class="smallfont">
<img class="inlineimg" src="images/icons/icon1.gif" alt="Default" border="0" />
</div>
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<!-- / icon and title -->
<!-- message -->
<div id="post_message_77225">
			
			Yes, if you look closely your request from your parent view has:<br />
- two flow execution keys (see how it's a _flowExecutionKey array!)<br />
- two event ids (in two different forms! _eventId=submitAddressSearchSubFlow and _eventId_addressSearch)<br />
<br />
I imagine you are also using a continuation repository.  So the first &quot;_flowExecutionKey&quot; in the array must be the key for the execution in the previous subflow's state -- which explains why it resumes from back in that point.<br />
<br />
We never cache anything related to the request -- request parameters are not cached.  The fact continuations still exist back in previously entered states of the subflow is expected with a continuation-based repository.<br />
<br />
From my point of view, this points to some sort of JSP problem. Can you post your JSP and post your firefox page source before you do the erred submit.  Also, I'd recommend turning on logging at your container level or another level up at Spring MVC -- wherever you can get access to raw request parmeters -- to verify the incoming parameters are simply wrong.<br />
<br />
Also, it would be helpful to see a printout of the ResponseInstruction that renders your parent.jsp after the subflow returns--from your SWF logs.  I want to see what flow execution context/key is shown there.<br />
<br />
<br />
Keith
		</div>
<!-- / message -->
<!-- sig -->
<div>
				__________________<br />
				Keith Donald<br />
Core Spring Development Team
			</div>
<!-- / sig -->
<!-- edit note -->
<div class="smallfont">
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<em>
					
						Last edited by Keith Donald; Sep 14th, 2006 at <span class="time">07:51 AM</span>.
					
					
				</em>
</div>
<!-- / edit note -->
<div style="margin-top: 10px" align="right">
<!-- controls -->
<a href="newreply.php?do=newreply&amp;p=77225" rel="nofollow"><img src="images/buttons/quote.gif" alt="Reply With Quote" border="0" /></a>
<a href="newreply.php?do=newreply&amp;p=77225" rel="nofollow" onclick="return false"><img src="images/buttons/multiquote_off.gif" alt="Multi-Quote This Message" border="0" id="mq_77225" /></a>
<a href="newreply.php?do=newreply&amp;p=77225" rel="nofollow" id="qr_77225" onclick="return false"><img src="images/buttons/quickreply.gif" alt="Quick reply to this message" border="0" /></a>
<!-- / controls -->
</div>
<!-- message, attachments, sig -->
</td>
</tr>
</table>
<!-- post 77225 popup menu -->
<div class="vbmenu_popup" id="postmenu_77225_menu" style="display:none;">
<table cellpadding="4" cellspacing="1" border="0">
<tr>
<td class="thead">Keith Donald</td>
</tr>
<tr><td class="vbmenu_option"><a href="member.php?u=6371">View Public Profile</a></td></tr>
<tr><td class="vbmenu_option"><a href="private.php?do=newpm&amp;u=6371" rel="nofollow">Send a private message to Keith Donald</a></td></tr>
<tr><td class="vbmenu_option"><a href="http://blog.springsource.com">Visit Keith Donald's homepage!</a></td></tr>
<tr><td class="vbmenu_option"><a href="search.php?do=finduser&amp;u=6371" rel="nofollow">Find all posts by Keith Donald</a></td></tr>
<tr><td class="vbmenu_option"><a href="profile.php?do=addlist&amp;userlist=buddy&amp;u=6371">Add Keith Donald to Your Contacts</a></td></tr>
</table>
</div>
<!-- / post 77225 popup menu -->
</div>
</div>
</div>
</div>
<!-- / close content container -->
<!-- / post #77225 --><!-- post #77240 -->
<!-- open content container -->
<div align="center">
<div class="page" style="width:100%; text-align:left">
<div style="padding:0px 0px 0px 0px" align="left">
<div id="edit77240" style="padding:0px 0px 6px 0px">
<!-- this is not the last post shown on the page -->
<table class="tborder" id="post77240" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
			&nbsp;
			#<a href="showpost.php?p=77240&amp;postcount=12" target="new" rel="nofollow" id="postcount77240" name="12"><strong>12</strong></a> &nbsp;
			
			
			<a href="report.php?p=77240" rel="nofollow"><img class="inlineimg" src="images/buttons/report.gif" alt="Report Post" border="0" /></a> &nbsp;
			
			
		</div>
<div class="normal">
<!-- status icon and date -->
<a name="post77240"><img class="inlineimg" src="images/statusicon/post_old.gif" alt="Old" border="0" /></a>
			
				Sep 14th, 2006, 09:21 AM
			
			
			<!-- / status icon and date -->
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<!-- user info -->
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td nowrap="nowrap">
<div id="postmenu_77240">
<a class="bigusername" href="member.php?u=7664">Paul Newport</a>
<img class="inlineimg" src="images/statusicon/user_offline.gif" alt="Paul Newport is offline" border="0" />
<script type="text/javascript"> vbmenu_register("postmenu_77240", true); </script>
</div>
<div class="smallfont">Senior Member</div>
</td>
<td width="100%">&nbsp;</td>
<td valign="top" nowrap="nowrap">
<div class="smallfont">
<div>Join Date: Sep 2004</div>
<div>
						Posts: 576
					</div>
<div> </div>
</div>
</td>
</tr>
</table>
<!-- / user info -->
</td>
</tr>
<tr>
<td class="alt1" id="td_post_77240">
<!-- message, attachments, sig -->
<!-- icon and title -->
<div class="smallfont">
<img class="inlineimg" src="images/icons/icon1.gif" alt="Default" border="0" />
</div>
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<!-- / icon and title -->
<!-- message -->
<div id="post_message_77240">
			
			The subflow gets passed in an address, and if that address is unique, it formats it and passes it back to the parent flow. In that situation, we never get the bug.<br />
<br />
If the address passed in is not unique (e.g. house number left off), a list of addresses is shown and the user picks one off the list. In this circumstance we are displaying a list of hrefs of all the possible addresses that match, which then do a call to the sub flow, as in this link<br />
<br />
<a href="http://localhost:9080/RetailerInputWeb/app/myApp.swf?_flowExecutionKey=_cA46516B5-F85A-0769-375F-7494652AC6A9_k6DFE2E7E-8FCF-2037-63FC-3FC9AB64CFB4&amp;_eventId=submitAddressSearchSubFlow&amp;dps=1D&amp;postCode=BS20%207DP" target="_blank" rel="nofollow">http://localhost:9080/RetailerInputW...ode=BS20%207DP</a><br />
<br />
It is only in this case that we get the error in the parent key, if this address list never pops up in the sub-flow, the parent flow works fine after the sub-flow has ended, so I think the addressSearch sub-flow calling itself could be the cause of the problem. Here's the definition of that again:<br />
<br />
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Code:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px inset;
		width: 800px;
		height: 498px;
		text-align: left;
		overflow: auto">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;

&lt;flow xmlns=&quot;http://www.springframework.org/schema/webflow&quot;
	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
	xsi:schemaLocation=&quot;http://www.springframework.org/schema/webflow
                          http://www.springframework.org/schema/webflow/spring-webflow-1.0.xsd&quot; &gt;

	

	&lt;input-mapper&gt;
		&lt;mapping source=&quot;addressToPassIn&quot;
			target=&quot;flowScope.testAddress&quot; /&gt;
		&lt;mapping source=&quot;postCode&quot; target=&quot;flowScope.postCode&quot; /&gt;
		&lt;mapping source=&quot;dps&quot; target=&quot;flowScope.dps&quot; /&gt;

	&lt;/input-mapper&gt;

	&lt;start-state idref=&quot;doSearch&quot; /&gt;


	&lt;action-state id=&quot;doSearch&quot;&gt;
		&lt;action bean=&quot;addressSearchAction&quot; method=&quot;getFormattedAddress&quot; /&gt;
		&lt;transition on=&quot;success&quot; to=&quot;addressListNeeded&quot; /&gt;
	&lt;/action-state&gt;


	&lt;decision-state id=&quot;addressListNeeded&quot;&gt;
		&lt;if test=&quot;${flowScope.addressSearchCommand.addressListNeeded}&quot;
			then=&quot;addressList&quot; else=&quot;finish&quot; /&gt;
	&lt;/decision-state&gt;

	&lt;view-state id=&quot;addressList&quot; view=&quot;addressList&quot;&gt;


		&lt;transition on=&quot;submitAddressSearchSubFlow&quot; to=&quot;selectAddress&quot;&gt;
			&lt;action bean=&quot;addressSearchAction&quot;
				method=&quot;bindAndValidate&quot;&gt;

			&lt;/action&gt;
		&lt;/transition&gt;
	&lt;/view-state&gt;

	&lt;subflow-state id=&quot;selectAddress&quot; flow=&quot;addressSearch&quot;&gt;
		&lt;attribute-mapper&gt;
			&lt;input-mapper&gt;
				&lt;mapping source=&quot;${requestParameters.postCode}&quot;
					target=&quot;postCode&quot; /&gt;
				&lt;mapping source=&quot;${requestParameters.dps}&quot; target=&quot;dps&quot; /&gt;

			&lt;/input-mapper&gt;

			&lt;output-mapper&gt;
				&lt;mapping source=&quot;returnedAddress&quot;
					target=&quot;flowScope.addressSearchCommand.returnedAddress&quot; /&gt;

			&lt;/output-mapper&gt;
		&lt;/attribute-mapper&gt;
		&lt;transition on=&quot;finish&quot; to=&quot;doSearch&quot; /&gt;
	&lt;/subflow-state&gt;



	&lt;end-state id=&quot;finish&quot;&gt;


	&lt;/end-state&gt;
	&lt;output-mapper&gt;
		&lt;mapping source=&quot;${flowScope.testAddress}&quot; target=&quot;testOut&quot; /&gt;
		&lt;mapping
			source=&quot;${flowScope.addressSearchCommand.addressToPassBack}&quot;
			target=&quot;addressToPassBack&quot; /&gt;

	&lt;/output-mapper&gt;
	&lt;import resource=&quot;contexts/addressSearchContext.xml&quot; /&gt;


&lt;/flow&gt;</pre>
</div>I've attached the files ask asked for. In the log, the first call to the sub flow takes place at 14/09/06 13:49:13:338. The sub flow pops up a list of addresses, and returns to the parent flow at 13:49:59:915 BST<br />
<br />
[14/09/06 13:49:59:915 BST] 00000039 SystemOut     O 2006-09-14 13:49:59,915 [WebContainer : 2] DEBUG org.springframework.webflow.engine.ViewState - Entering state 'headOfficeDetails' of flow 'retailerInputWizard'<br />
<br />
I then change the adddress on the parent jsp to be something else, hit search again, and it dives straight into the sub-flow again at  13:53:05,677<br />
<br />
I've turned on debug logging for org.springframework in my  log4j configuration file, but it looks like this is not doing enough as I cannot see any reference to ResponseInstruction in the logs.<br />
<br />
Code levels are Spring 2 RC 3 and spring-webflow-1.0-rc4-20060912224118.jar<br />
<br />
I really appreciate your help in this !
		</div>
<!-- / message -->
<!-- attachments -->
<div style="padding:6px">
<fieldset class="fieldset">
<legend>Attached Files</legend>
<table cellpadding="0" cellspacing="3" border="0">
<tr>
<td><img class="inlineimg" src="images/attach/txt.gif" alt="File Type: txt" width="16" height="16" border="0" style="vertical-align:baseline" /></td>
<td><a href="attachment.php?attachmentid=305&amp;d=1158239345">addressList.jsp.txt</a> (1.8 KB, 1 views)</td>
</tr><tr>
<td><img class="inlineimg" src="images/attach/txt.gif" alt="File Type: txt" width="16" height="16" border="0" style="vertical-align:baseline" /></td>
<td><a href="attachment.php?attachmentid=306&amp;d=1158239352">addressListViewSource.txt</a> (8.6 KB, 1 views)</td>
</tr><tr>
<td><img class="inlineimg" src="images/attach/txt.gif" alt="File Type: txt" width="16" height="16" border="0" style="vertical-align:baseline" /></td>
<td><a href="attachment.php?attachmentid=307&amp;d=1158239360">headOfficeDetails.jsp.txt</a> (5.1 KB, 1 views)</td>
</tr><tr>
<td><img class="inlineimg" src="images/attach/txt.gif" alt="File Type: txt" width="16" height="16" border="0" style="vertical-align:baseline" /></td>
<td><a href="attachment.php?attachmentid=308&amp;d=1158239370">headOfficeDetailsSourceBeforeErrorSubmit.txt</a> (1.6 KB, 1 views)</td>
</tr><tr>
<td><img class="inlineimg" src="images/attach/zip.gif" alt="File Type: zip" width="16" height="16" border="0" style="vertical-align:baseline" /></td>
<td><a href="attachment.php?attachmentid=309&amp;d=1158239603">logFile.zip</a> (24.0 KB, 1 views)</td>
</tr>
</table>
</fieldset>
</div>
<!-- / attachments -->
<div style="margin-top: 10px" align="right">
<!-- controls -->
<a href="newreply.php?do=newreply&amp;p=77240" rel="nofollow"><img src="images/buttons/quote.gif" alt="Reply With Quote" border="0" /></a>
<a href="newreply.php?do=newreply&amp;p=77240" rel="nofollow" onclick="return false"><img src="images/buttons/multiquote_off.gif" alt="Multi-Quote This Message" border="0" id="mq_77240" /></a>
<a href="newreply.php?do=newreply&amp;p=77240" rel="nofollow" id="qr_77240" onclick="return false"><img src="images/buttons/quickreply.gif" alt="Quick reply to this message" border="0" /></a>
<!-- / controls -->
</div>
<!-- message, attachments, sig -->
</td>
</tr>
</table>
<!-- post 77240 popup menu -->
<div class="vbmenu_popup" id="postmenu_77240_menu" style="display:none;">
<table cellpadding="4" cellspacing="1" border="0">
<tr>
<td class="thead">Paul Newport</td>
</tr>
<tr><td class="vbmenu_option"><a href="member.php?u=7664">View Public Profile</a></td></tr>
<tr><td class="vbmenu_option"><a href="private.php?do=newpm&amp;u=7664" rel="nofollow">Send a private message to Paul Newport</a></td></tr>
<tr><td class="vbmenu_option"><a href="search.php?do=finduser&amp;u=7664" rel="nofollow">Find all posts by Paul Newport</a></td></tr>
<tr><td class="vbmenu_option"><a href="profile.php?do=addlist&amp;userlist=buddy&amp;u=7664">Add Paul Newport to Your Contacts</a></td></tr>
</table>
</div>
<!-- / post 77240 popup menu -->
</div>
</div>
</div>
</div>
<!-- / close content container -->
<!-- / post #77240 --><!-- post #77242 -->
<!-- open content container -->
<div align="center">
<div class="page" style="width:100%; text-align:left">
<div style="padding:0px 0px 0px 0px" align="left">
<div id="edit77242" style="padding:0px 0px 6px 0px">
<!-- this is not the last post shown on the page -->
<table class="tborder" id="post77242" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
			&nbsp;
			#<a href="showpost.php?p=77242&amp;postcount=13" target="new" rel="nofollow" id="postcount77242" name="13"><strong>13</strong></a> &nbsp;
			
			
			<a href="report.php?p=77242" rel="nofollow"><img class="inlineimg" src="images/buttons/report.gif" alt="Report Post" border="0" /></a> &nbsp;
			
			
		</div>
<div class="normal">
<!-- status icon and date -->
<a name="post77242"><img class="inlineimg" src="images/statusicon/post_old.gif" alt="Old" border="0" /></a>
			
				Sep 14th, 2006, 09:28 AM
			
			
			<!-- / status icon and date -->
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<!-- user info -->
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td nowrap="nowrap">
<div id="postmenu_77242">
<a class="bigusername" href="member.php?u=7664">Paul Newport</a>
<img class="inlineimg" src="images/statusicon/user_offline.gif" alt="Paul Newport is offline" border="0" />
<script type="text/javascript"> vbmenu_register("postmenu_77242", true); </script>
</div>
<div class="smallfont">Senior Member</div>
</td>
<td width="100%">&nbsp;</td>
<td valign="top" nowrap="nowrap">
<div class="smallfont">
<div>Join Date: Sep 2004</div>
<div>
						Posts: 576
					</div>
<div> </div>
</div>
</td>
</tr>
</table>
<!-- / user info -->
</td>
</tr>
<tr>
<td class="alt1" id="td_post_77242">
<!-- message, attachments, sig -->
<!-- icon and title -->
<div class="smallfont">
<img class="inlineimg" src="images/icons/icon1.gif" alt="Default" border="0" />
</div>
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<!-- / icon and title -->
<!-- message -->
<div id="post_message_77242">
			
			Also of relevance is a JSP include that the main JSP uses, which contains this:<br />
<br />
<br />
&lt;input 	name=&quot;_eventId_submit&quot; type=&quot;submit&quot; value=&quot;Next&quot;&gt; <br />
&lt;input 	type=&quot;hidden&quot; name=&quot;_flowExecutionKey&quot; value=&quot;${flowExecutionKey}&quot;&gt;
		</div>
<!-- / message -->
<div style="margin-top: 10px" align="right">
<!-- controls -->
<a href="newreply.php?do=newreply&amp;p=77242" rel="nofollow"><img src="images/buttons/quote.gif" alt="Reply With Quote" border="0" /></a>
<a href="newreply.php?do=newreply&amp;p=77242" rel="nofollow" onclick="return false"><img src="images/buttons/multiquote_off.gif" alt="Multi-Quote This Message" border="0" id="mq_77242" /></a>
<a href="newreply.php?do=newreply&amp;p=77242" rel="nofollow" id="qr_77242" onclick="return false"><img src="images/buttons/quickreply.gif" alt="Quick reply to this message" border="0" /></a>
<!-- / controls -->
</div>
<!-- message, attachments, sig -->
</td>
</tr>
</table>
<!-- post 77242 popup menu -->
<div class="vbmenu_popup" id="postmenu_77242_menu" style="display:none;">
<table cellpadding="4" cellspacing="1" border="0">
<tr>
<td class="thead">Paul Newport</td>
</tr>
<tr><td class="vbmenu_option"><a href="member.php?u=7664">View Public Profile</a></td></tr>
<tr><td class="vbmenu_option"><a href="private.php?do=newpm&amp;u=7664" rel="nofollow">Send a private message to Paul Newport</a></td></tr>
<tr><td class="vbmenu_option"><a href="search.php?do=finduser&amp;u=7664" rel="nofollow">Find all posts by Paul Newport</a></td></tr>
<tr><td class="vbmenu_option"><a href="profile.php?do=addlist&amp;userlist=buddy&amp;u=7664">Add Paul Newport to Your Contacts</a></td></tr>
</table>
</div>
<!-- / post 77242 popup menu -->
</div>
</div>
</div>
</div>
<!-- / close content container -->
<!-- / post #77242 --><!-- post #77245 -->
<!-- open content container -->
<div align="center">
<div class="page" style="width:100%; text-align:left">
<div style="padding:0px 0px 0px 0px" align="left">
<div id="edit77245" style="padding:0px 0px 6px 0px">
<!-- this is not the last post shown on the page -->
<table class="tborder" id="post77245" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
			&nbsp;
			#<a href="showpost.php?p=77245&amp;postcount=14" target="new" rel="nofollow" id="postcount77245" name="14"><strong>14</strong></a> &nbsp;
			
			
			<a href="report.php?p=77245" rel="nofollow"><img class="inlineimg" src="images/buttons/report.gif" alt="Report Post" border="0" /></a> &nbsp;
			
			
		</div>
<div class="normal">
<!-- status icon and date -->
<a name="post77245"><img class="inlineimg" src="images/statusicon/post_old.gif" alt="Old" border="0" /></a>
			
				Sep 14th, 2006, 10:00 AM
			
			
			<!-- / status icon and date -->
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<!-- user info -->
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td class="alt2"><a href="member.php?u=6371"><img src="image.php?u=6371&amp;dateline=1288973702" width="56" height="77" alt="Keith Donald's Avatar" border="0" /></a></td>
<td nowrap="nowrap">
<div id="postmenu_77245">
<a class="bigusername" href="member.php?u=6371">Keith Donald</a>
<img class="inlineimg" src="images/statusicon/user_offline.gif" alt="Keith Donald is offline" border="0" />
<script type="text/javascript"> vbmenu_register("postmenu_77245", true); </script>
</div>
<div class="smallfont">Web App Development Lead</div>
<div class="smallfont">Spring Team</div>
</td>
<td width="100%">&nbsp;</td>
<td valign="top" nowrap="nowrap">
<div class="smallfont">
<div>Join Date: Aug 2004</div>
<div>Location: Melbourne, FL</div>
<div>
						Posts: 2,555
					</div>
<div> </div>
</div>
</td>
</tr>
</table>
<!-- / user info -->
</td>
</tr>
<tr>
<td class="alt1" id="td_post_77245">
<!-- message, attachments, sig -->
<!-- icon and title -->
<div class="smallfont">
<img class="inlineimg" src="images/icons/icon1.gif" alt="Default" border="0" />
</div>
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<!-- / icon and title -->
<!-- message -->
<div id="post_message_77245">
			
			First off, I can eliminate any possibility of problem in the core execution engine.<br />
<br />
The problem is at the browser level.  Your browser is sending in the wrong flowExecutionKey when you click on one of your address links which resumes the flow from a previous point in time (the subflow) which is not what you expect.<br />
<br />
Likely, since your address links are HREFs included within an outer form element, you're submitting the parameters twice... <br />
<br />
If you look, you'll see two submitted keys are different as well:<br />
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Code:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px inset;
		width: 800px;
		height: 66px;
		text-align: left;
		overflow: auto">_flowExecutionKey' -&gt; array&lt;String&gt;
  '_cF728EBE2-E870-A5AD-59B5-57D457934EE8_kE6C5E516-4424-D721-91CD-9114DD99F700'    
  '_cF728EBE2-E870-A5AD-59B5-57D457934EE8_k45FA78E9-7417-5DEE-A723-C6ED52731F1D'</pre>
</div>One of those is likely right, pointing to the current flow execution (in your parent flow), the other wrong [probably the first one], pointing to a previously traversed state -- back in the subflow.  I'm not quite sure how two different keys are getting submitted like this, something to figure out.<br />
<br />
The logs do include ResponseInstruction logging--just search for ResponseInstruction.  All I need is org.springframework.webflow turned on :-)
		</div>
<!-- / message -->
<!-- sig -->
<div>
				__________________<br />
				Keith Donald<br />
Core Spring Development Team
			</div>
<!-- / sig -->
<!-- edit note -->
<div class="smallfont">
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<em>
					
						Last edited by Keith Donald; Sep 14th, 2006 at <span class="time">10:05 AM</span>.
					
					
				</em>
</div>
<!-- / edit note -->
<div style="margin-top: 10px" align="right">
<!-- controls -->
<a href="newreply.php?do=newreply&amp;p=77245" rel="nofollow"><img src="images/buttons/quote.gif" alt="Reply With Quote" border="0" /></a>
<a href="newreply.php?do=newreply&amp;p=77245" rel="nofollow" onclick="return false"><img src="images/buttons/multiquote_off.gif" alt="Multi-Quote This Message" border="0" id="mq_77245" /></a>
<a href="newreply.php?do=newreply&amp;p=77245" rel="nofollow" id="qr_77245" onclick="return false"><img src="images/buttons/quickreply.gif" alt="Quick reply to this message" border="0" /></a>
<!-- / controls -->
</div>
<!-- message, attachments, sig -->
</td>
</tr>
</table>
<!-- post 77245 popup menu -->
<div class="vbmenu_popup" id="postmenu_77245_menu" style="display:none;">
<table cellpadding="4" cellspacing="1" border="0">
<tr>
<td class="thead">Keith Donald</td>
</tr>
<tr><td class="vbmenu_option"><a href="member.php?u=6371">View Public Profile</a></td></tr>
<tr><td class="vbmenu_option"><a href="private.php?do=newpm&amp;u=6371" rel="nofollow">Send a private message to Keith Donald</a></td></tr>
<tr><td class="vbmenu_option"><a href="http://blog.springsource.com">Visit Keith Donald's homepage!</a></td></tr>
<tr><td class="vbmenu_option"><a href="search.php?do=finduser&amp;u=6371" rel="nofollow">Find all posts by Keith Donald</a></td></tr>
<tr><td class="vbmenu_option"><a href="profile.php?do=addlist&amp;userlist=buddy&amp;u=6371">Add Keith Donald to Your Contacts</a></td></tr>
</table>
</div>
<!-- / post 77245 popup menu -->
</div>
</div>
</div>
</div>
<!-- / close content container -->
<!-- / post #77245 --><!-- post #77247 -->
<!-- open content container -->
<div align="center">
<div class="page" style="width:100%; text-align:left">
<div style="padding:0px 0px 0px 0px" align="left">
<div id="edit77247" style="padding:0px 0px 6px 0px">
<!-- this is not the last post shown on the page -->
<table class="tborder" id="post77247" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
			&nbsp;
			#<a href="showpost.php?p=77247&amp;postcount=15" target="new" rel="nofollow" id="postcount77247" name="15"><strong>15</strong></a> &nbsp;
			
			
			<a href="report.php?p=77247" rel="nofollow"><img class="inlineimg" src="images/buttons/report.gif" alt="Report Post" border="0" /></a> &nbsp;
			
			
		</div>
<div class="normal">
<!-- status icon and date -->
<a name="post77247"><img class="inlineimg" src="images/statusicon/post_old.gif" alt="Old" border="0" /></a>
			
				Sep 14th, 2006, 10:47 AM
			
			
			<!-- / status icon and date -->
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<!-- user info -->
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td class="alt2"><a href="member.php?u=6371"><img src="image.php?u=6371&amp;dateline=1288973702" width="56" height="77" alt="Keith Donald's Avatar" border="0" /></a></td>
<td nowrap="nowrap">
<div id="postmenu_77247">
<a class="bigusername" href="member.php?u=6371">Keith Donald</a>
<img class="inlineimg" src="images/statusicon/user_offline.gif" alt="Keith Donald is offline" border="0" />
<script type="text/javascript"> vbmenu_register("postmenu_77247", true); </script>
</div>
<div class="smallfont">Web App Development Lead</div>
<div class="smallfont">Spring Team</div>
</td>
<td width="100%">&nbsp;</td>
<td valign="top" nowrap="nowrap">
<div class="smallfont">
<div>Join Date: Aug 2004</div>
<div>Location: Melbourne, FL</div>
<div>
						Posts: 2,555
					</div>
<div> </div>
</div>
</td>
</tr>
</table>
<!-- / user info -->
</td>
</tr>
<tr>
<td class="alt1" id="td_post_77247">
<!-- message, attachments, sig -->
<!-- icon and title -->
<div class="smallfont">
<img class="inlineimg" src="images/icons/icon1.gif" alt="Default" border="0" />
</div>
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<!-- / icon and title -->
<!-- message -->
<div id="post_message_77247">
			
			Alright I'm pretty sure I know what is happening.<br />
<br />
- You launch the subflow<br />
- You enter a address that's not unique<br />
- You select an address using the HREF<br />
- Now you're back in the parent flow and you continue via submit, BOOM, the event is signaled aganst the subflow...<br />
<br />
Now, check your browser URL before you do that submit when you're back in the parent flow.  I bet you the old flow execution key (and old parameters) are embedded in it -- because clicking on the HREF issued a GET.  This would explain why they're being resubmitted, combined with your parent flow form parameters when you click submit... and why the flow exectution is resuming back in the subflow unexpectedly.<br />
<br />
You might want to consider turning on &quot;alwaysRedirectOnPause&quot;.  This way even after your get to the HREF, SWF will always do a redirect to the correct execution URL when entering the next view state.<br />
<br />
Keith
		</div>
<!-- / message -->
<!-- sig -->
<div>
				__________________<br />
				Keith Donald<br />
Core Spring Development Team
			</div>
<!-- / sig -->
<!-- edit note -->
<div class="smallfont">
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<em>
					
						Last edited by Keith Donald; Sep 14th, 2006 at <span class="time">10:52 AM</span>.
					
					
				</em>
</div>
<!-- / edit note -->
<div style="margin-top: 10px" align="right">
<!-- controls -->
<a href="newreply.php?do=newreply&amp;p=77247" rel="nofollow"><img src="images/buttons/quote.gif" alt="Reply With Quote" border="0" /></a>
<a href="newreply.php?do=newreply&amp;p=77247" rel="nofollow" onclick="return false"><img src="images/buttons/multiquote_off.gif" alt="Multi-Quote This Message" border="0" id="mq_77247" /></a>
<a href="newreply.php?do=newreply&amp;p=77247" rel="nofollow" id="qr_77247" onclick="return false"><img src="images/buttons/quickreply.gif" alt="Quick reply to this message" border="0" /></a>
<!-- / controls -->
</div>
<!-- message, attachments, sig -->
</td>
</tr>
</table>
<!-- post 77247 popup menu -->
<div class="vbmenu_popup" id="postmenu_77247_menu" style="display:none;">
<table cellpadding="4" cellspacing="1" border="0">
<tr>
<td class="thead">Keith Donald</td>
</tr>
<tr><td class="vbmenu_option"><a href="member.php?u=6371">View Public Profile</a></td></tr>
<tr><td class="vbmenu_option"><a href="private.php?do=newpm&amp;u=6371" rel="nofollow">Send a private message to Keith Donald</a></td></tr>
<tr><td class="vbmenu_option"><a href="http://blog.springsource.com">Visit Keith Donald's homepage!</a></td></tr>
<tr><td class="vbmenu_option"><a href="search.php?do=finduser&amp;u=6371" rel="nofollow">Find all posts by Keith Donald</a></td></tr>
<tr><td class="vbmenu_option"><a href="profile.php?do=addlist&amp;userlist=buddy&amp;u=6371">Add Keith Donald to Your Contacts</a></td></tr>
</table>
</div>
<!-- / post 77247 popup menu -->
</div>
</div>
</div>
</div>
<!-- / close content container -->
<!-- / post #77247 --><!-- post #77269 -->
<!-- open content container -->
<div align="center">
<div class="page" style="width:100%; text-align:left">
<div style="padding:0px 0px 0px 0px" align="left">
<div id="edit77269" style="padding:0px 0px 6px 0px">
<!-- this is not the last post shown on the page -->
<table class="tborder" id="post77269" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
			&nbsp;
			#<a href="showpost.php?p=77269&amp;postcount=16" target="new" rel="nofollow" id="postcount77269" name="16"><strong>16</strong></a> &nbsp;
			
			
			<a href="report.php?p=77269" rel="nofollow"><img class="inlineimg" src="images/buttons/report.gif" alt="Report Post" border="0" /></a> &nbsp;
			
			
		</div>
<div class="normal">
<!-- status icon and date -->
<a name="post77269"><img class="inlineimg" src="images/statusicon/post_old.gif" alt="Old" border="0" /></a>
			
				Sep 14th, 2006, 11:43 AM
			
			
			<!-- / status icon and date -->
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<!-- user info -->
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td nowrap="nowrap">
<div id="postmenu_77269">
<a class="bigusername" href="member.php?u=7550">klr8</a>
<img class="inlineimg" src="images/statusicon/user_offline.gif" alt="klr8 is offline" border="0" />
<script type="text/javascript"> vbmenu_register("postmenu_77269", true); </script>
</div>
<div class="smallfont">Senior Member</div>
<div class="smallfont">Spring Team</div>
</td>
<td width="100%">&nbsp;</td>
<td valign="top" nowrap="nowrap">
<div class="smallfont">
<div>Join Date: Sep 2004</div>
<div>Location: Leuven, Belgium</div>
<div>
						Posts: 1,846
					</div>
<div> </div>
</div>
</td>
</tr>
</table>
<!-- / user info -->
</td>
</tr>
<tr>
<td class="alt1" id="td_post_77269">
<!-- message, attachments, sig -->
<!-- icon and title -->
<div class="smallfont">
<img class="inlineimg" src="images/icons/icon1.gif" alt="Default" border="0" />
</div>
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<!-- / icon and title -->
<!-- message -->
<div id="post_message_77269">
			
			I haven't fully digested this thread yet, but as an immediate remark after reading the first post:<br />
<br />
We have had a similar problem before where a subflow was using an action state and if there was a exception there, it would be reported incorrectly. I don't remember the exact details, but that's why we introduced the special NoMatchingActionResultTransitionException in the ActionState<br />
<br />
Erwin
		</div>
<!-- / message -->
<div style="margin-top: 10px" align="right">
<!-- controls -->
<a href="newreply.php?do=newreply&amp;p=77269" rel="nofollow"><img src="images/buttons/quote.gif" alt="Reply With Quote" border="0" /></a>
<a href="newreply.php?do=newreply&amp;p=77269" rel="nofollow" onclick="return false"><img src="images/buttons/multiquote_off.gif" alt="Multi-Quote This Message" border="0" id="mq_77269" /></a>
<a href="newreply.php?do=newreply&amp;p=77269" rel="nofollow" id="qr_77269" onclick="return false"><img src="images/buttons/quickreply.gif" alt="Quick reply to this message" border="0" /></a>
<!-- / controls -->
</div>
<!-- message, attachments, sig -->
</td>
</tr>
</table>
<!-- post 77269 popup menu -->
<div class="vbmenu_popup" id="postmenu_77269_menu" style="display:none;">
<table cellpadding="4" cellspacing="1" border="0">
<tr>
<td class="thead">klr8</td>
</tr>
<tr><td class="vbmenu_option"><a href="member.php?u=7550">View Public Profile</a></td></tr>
<tr><td class="vbmenu_option"><a href="http://www.ervacon.com">Visit klr8's homepage!</a></td></tr>
<tr><td class="vbmenu_option"><a href="search.php?do=finduser&amp;u=7550" rel="nofollow">Find all posts by klr8</a></td></tr>
<tr><td class="vbmenu_option"><a href="profile.php?do=addlist&amp;userlist=buddy&amp;u=7550">Add klr8 to Your Contacts</a></td></tr>
</table>
</div>
<!-- / post 77269 popup menu -->
</div>
</div>
</div>
</div>
<!-- / close content container -->
<!-- / post #77269 --><!-- post #77274 -->
<!-- open content container -->
<div align="center">
<div class="page" style="width:100%; text-align:left">
<div style="padding:0px 0px 0px 0px" align="left">
<div id="edit77274" style="padding:0px 0px 6px 0px">
<!-- this is not the last post shown on the page -->
<table class="tborder" id="post77274" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
			&nbsp;
			#<a href="showpost.php?p=77274&amp;postcount=17" target="new" rel="nofollow" id="postcount77274" name="17"><strong>17</strong></a> &nbsp;
			
			
			<a href="report.php?p=77274" rel="nofollow"><img class="inlineimg" src="images/buttons/report.gif" alt="Report Post" border="0" /></a> &nbsp;
			
			
		</div>
<div class="normal">
<!-- status icon and date -->
<a name="post77274"><img class="inlineimg" src="images/statusicon/post_old.gif" alt="Old" border="0" /></a>
			
				Sep 14th, 2006, 12:06 PM
			
			
			<!-- / status icon and date -->
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<!-- user info -->
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td nowrap="nowrap">
<div id="postmenu_77274">
<a class="bigusername" href="member.php?u=7664">Paul Newport</a>
<img class="inlineimg" src="images/statusicon/user_offline.gif" alt="Paul Newport is offline" border="0" />
<script type="text/javascript"> vbmenu_register("postmenu_77274", true); </script>
</div>
<div class="smallfont">Senior Member</div>
</td>
<td width="100%">&nbsp;</td>
<td valign="top" nowrap="nowrap">
<div class="smallfont">
<div>Join Date: Sep 2004</div>
<div>
						Posts: 576
					</div>
<div> </div>
</div>
</td>
</tr>
</table>
<!-- / user info -->
</td>
</tr>
<tr>
<td class="alt1" id="td_post_77274">
<!-- message, attachments, sig -->
<!-- icon and title -->
<div class="smallfont">
<img class="inlineimg" src="images/icons/icon1.gif" alt="Default" border="0" />
</div>
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<!-- / icon and title -->
<!-- message -->
<div id="post_message_77274">
			
			Brilliant ! Spot on !<br />
<br />
I suppose you won't believe me for a moment when I say I had just worked that out as well, but wouldn't have known about the alwaysRedirectOnPause attribute.<br />
<br />
One final question then, when I do this, it redirects to here:<br />
<br />
<a href="http://localhost:9080/RetailerInputWeb/app?_flowExecutionKey=_cA8383B40-DB34-8236-CAA7-E2BAB48822DA_k8B461F78-8B81-6777-DA0A-70285676D804" target="_blank" rel="nofollow">http://localhost:9080/RetailerInputW...A-70285676D804</a><br />
<br />
not here:<br />
<br />
<a href="http://localhost:9080/RetailerInputWeb/app/myApp.swf?_flowId=retailerInputWizard?_flowExecutionKey=_cA8383B40-DB34-8236-CAA7-E2BAB48822DA_k8B461F78-8B81-6777-DA0A-70285676D804" target="_blank" rel="nofollow">http://localhost:9080/RetailerInputW...A-70285676D804</a><br />
<br />
i.e. it's missing myApp.swf which is defined here:<br />
<br />
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Code:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px inset;
		width: 800px;
		height: 242px;
		text-align: left;
		overflow: auto">&lt;flow:executor id=&quot;flowExecutor&quot; registry-ref=&quot;flowRegistry&quot;
		repository-type=&quot;continuation&quot;&gt;

		&lt;flow:execution-attributes&gt;
			&lt;flow:alwaysRedirectOnPause /&gt;
		&lt;/flow:execution-attributes&gt;
	&lt;/flow:executor&gt;
	&lt;flow:registry id=&quot;flowRegistry&quot;&gt;
		&lt;flow:location path=&quot;/WEB-INF/flows/**.xml&quot; /&gt;
	&lt;/flow:registry&gt;
&lt;bean name=&quot;/myApp.swf&quot;
		class=&quot;org.springframework.webflow.executor.mvc.FlowController&quot;&gt;
		&lt;property name=&quot;flowExecutor&quot; ref=&quot;flowExecutor&quot; /&gt;
	&lt;/bean&gt;</pre>
</div>
</div>
<!-- / message -->
<div style="margin-top: 10px" align="right">
<!-- controls -->
<a href="newreply.php?do=newreply&amp;p=77274" rel="nofollow"><img src="images/buttons/quote.gif" alt="Reply With Quote" border="0" /></a>
<a href="newreply.php?do=newreply&amp;p=77274" rel="nofollow" onclick="return false"><img src="images/buttons/multiquote_off.gif" alt="Multi-Quote This Message" border="0" id="mq_77274" /></a>
<a href="newreply.php?do=newreply&amp;p=77274" rel="nofollow" id="qr_77274" onclick="return false"><img src="images/buttons/quickreply.gif" alt="Quick reply to this message" border="0" /></a>
<!-- / controls -->
</div>
<!-- message, attachments, sig -->
</td>
</tr>
</table>
<!-- post 77274 popup menu -->
<div class="vbmenu_popup" id="postmenu_77274_menu" style="display:none;">
<table cellpadding="4" cellspacing="1" border="0">
<tr>
<td class="thead">Paul Newport</td>
</tr>
<tr><td class="vbmenu_option"><a href="member.php?u=7664">View Public Profile</a></td></tr>
<tr><td class="vbmenu_option"><a href="private.php?do=newpm&amp;u=7664" rel="nofollow">Send a private message to Paul Newport</a></td></tr>
<tr><td class="vbmenu_option"><a href="search.php?do=finduser&amp;u=7664" rel="nofollow">Find all posts by Paul Newport</a></td></tr>
<tr><td class="vbmenu_option"><a href="profile.php?do=addlist&amp;userlist=buddy&amp;u=7664">Add Paul Newport to Your Contacts</a></td></tr>
</table>
</div>
<!-- / post 77274 popup menu -->
</div>
</div>
</div>
</div>
<!-- / close content container -->
<!-- / post #77274 --><!-- post #77292 -->
<!-- open content container -->
<div align="center">
<div class="page" style="width:100%; text-align:left">
<div style="padding:0px 0px 0px 0px" align="left">
<div id="edit77292" style="padding:0px 0px 6px 0px">
<!-- this is not the last post shown on the page -->
<table class="tborder" id="post77292" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
			&nbsp;
			#<a href="showpost.php?p=77292&amp;postcount=18" target="new" rel="nofollow" id="postcount77292" name="18"><strong>18</strong></a> &nbsp;
			
			
			<a href="report.php?p=77292" rel="nofollow"><img class="inlineimg" src="images/buttons/report.gif" alt="Report Post" border="0" /></a> &nbsp;
			
			
		</div>
<div class="normal">
<!-- status icon and date -->
<a name="post77292"><img class="inlineimg" src="images/statusicon/post_old.gif" alt="Old" border="0" /></a>
			
				Sep 14th, 2006, 02:03 PM
			
			
			<!-- / status icon and date -->
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<!-- user info -->
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td class="alt2"><a href="member.php?u=6371"><img src="image.php?u=6371&amp;dateline=1288973702" width="56" height="77" alt="Keith Donald's Avatar" border="0" /></a></td>
<td nowrap="nowrap">
<div id="postmenu_77292">
<a class="bigusername" href="member.php?u=6371">Keith Donald</a>
<img class="inlineimg" src="images/statusicon/user_offline.gif" alt="Keith Donald is offline" border="0" />
<script type="text/javascript"> vbmenu_register("postmenu_77292", true); </script>
</div>
<div class="smallfont">Web App Development Lead</div>
<div class="smallfont">Spring Team</div>
</td>
<td width="100%">&nbsp;</td>
<td valign="top" nowrap="nowrap">
<div class="smallfont">
<div>Join Date: Aug 2004</div>
<div>Location: Melbourne, FL</div>
<div>
						Posts: 2,555
					</div>
<div> </div>
</div>
</td>
</tr>
</table>
<!-- / user info -->
</td>
</tr>
<tr>
<td class="alt1" id="td_post_77292">
<!-- message, attachments, sig -->
<!-- icon and title -->
<div class="smallfont">
<img class="inlineimg" src="images/icons/icon1.gif" alt="Default" border="0" />
</div>
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<!-- / icon and title -->
<!-- message -->
<div id="post_message_77292">
			
			I would check to make sure your indeed the URL path you are posting to is correct, as to build the flow execution URL we simply prepend the context path and the dispatcher (servlet) path.  Might help to look at a sample like sellitem.<br />
<br />
Keith
		</div>
<!-- / message -->
<!-- sig -->
<div>
				__________________<br />
				Keith Donald<br />
Core Spring Development Team
			</div>
<!-- / sig -->
<div style="margin-top: 10px" align="right">
<!-- controls -->
<a href="newreply.php?do=newreply&amp;p=77292" rel="nofollow"><img src="images/buttons/quote.gif" alt="Reply With Quote" border="0" /></a>
<a href="newreply.php?do=newreply&amp;p=77292" rel="nofollow" onclick="return false"><img src="images/buttons/multiquote_off.gif" alt="Multi-Quote This Message" border="0" id="mq_77292" /></a>
<a href="newreply.php?do=newreply&amp;p=77292" rel="nofollow" id="qr_77292" onclick="return false"><img src="images/buttons/quickreply.gif" alt="Quick reply to this message" border="0" /></a>
<!-- / controls -->
</div>
<!-- message, attachments, sig -->
</td>
</tr>
</table>
<!-- post 77292 popup menu -->
<div class="vbmenu_popup" id="postmenu_77292_menu" style="display:none;">
<table cellpadding="4" cellspacing="1" border="0">
<tr>
<td class="thead">Keith Donald</td>
</tr>
<tr><td class="vbmenu_option"><a href="member.php?u=6371">View Public Profile</a></td></tr>
<tr><td class="vbmenu_option"><a href="private.php?do=newpm&amp;u=6371" rel="nofollow">Send a private message to Keith Donald</a></td></tr>
<tr><td class="vbmenu_option"><a href="http://blog.springsource.com">Visit Keith Donald's homepage!</a></td></tr>
<tr><td class="vbmenu_option"><a href="search.php?do=finduser&amp;u=6371" rel="nofollow">Find all posts by Keith Donald</a></td></tr>
<tr><td class="vbmenu_option"><a href="profile.php?do=addlist&amp;userlist=buddy&amp;u=6371">Add Keith Donald to Your Contacts</a></td></tr>
</table>
</div>
<!-- / post 77292 popup menu -->
</div>
</div>
</div>
</div>
<!-- / close content container -->
<!-- / post #77292 --><!-- post #77425 -->
<!-- open content container -->
<div align="center">
<div class="page" style="width:100%; text-align:left">
<div style="padding:0px 0px 0px 0px" align="left">
<div id="edit77425" style="padding:0px 0px 6px 0px">
<table class="tborder" id="post77425" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
			&nbsp;
			#<a href="showpost.php?p=77425&amp;postcount=19" target="new" rel="nofollow" id="postcount77425" name="19"><strong>19</strong></a> &nbsp;
			
			
			<a href="report.php?p=77425" rel="nofollow"><img class="inlineimg" src="images/buttons/report.gif" alt="Report Post" border="0" /></a> &nbsp;
			
			
		</div>
<div class="normal">
<!-- status icon and date -->
<a name="post77425"><img class="inlineimg" src="images/statusicon/post_old.gif" alt="Old" border="0" /></a>
			
				Sep 15th, 2006, 11:16 AM
			
			
			<!-- / status icon and date -->
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<!-- user info -->
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td nowrap="nowrap">
<div id="postmenu_77425">
<a class="bigusername" href="member.php?u=7664">Paul Newport</a>
<img class="inlineimg" src="images/statusicon/user_offline.gif" alt="Paul Newport is offline" border="0" />
<script type="text/javascript"> vbmenu_register("postmenu_77425", true); </script>
</div>
<div class="smallfont">Senior Member</div>
</td>
<td width="100%">&nbsp;</td>
<td valign="top" nowrap="nowrap">
<div class="smallfont">
<div>Join Date: Sep 2004</div>
<div>
						Posts: 576
					</div>
<div> </div>
</div>
</td>
</tr>
</table>
<!-- / user info -->
</td>
</tr>
<tr>
<td class="alt1" id="td_post_77425">
<!-- message, attachments, sig -->
<!-- icon and title -->
<div class="smallfont">
<img class="inlineimg" src="images/icons/icon1.gif" alt="Default" border="0" />
</div>
<hr size="1" style="color:#D1D1E1; background-color:#D1D1E1" />
<!-- / icon and title -->
<!-- message -->
<div id="post_message_77425">
<div style="margin:20px; margin-top:5px; ">
<div class="smallfont" style="margin-bottom:2px">Quote:</div>
<table cellpadding="6" cellspacing="0" border="0" width="100%">
<tr>
<td class="alt2" style="border:1px inset">
<div>
					Originally Posted by <strong>Keith Donald</strong>
</div>
<div style="font-style:italic">I would check to make sure your indeed the URL path you are posting to is correct, as to build the flow execution URL we simply prepend the context path and the dispatcher (servlet) path.  Might help to look at a sample like sellitem.<br />
<br />
Keith</div>
</td>
</tr>
</table>
</div><br />
the issue here was that my original url was of the format /myApp/something.htm and the redirection stuff only works if I reconfigured my app to use a url of the format /something.htm<br />
<br />
Anyway all sorted now so thanks for that.
		</div>
<!-- / message -->
<div style="margin-top: 10px" align="right">
<!-- controls -->
<a href="newreply.php?do=newreply&amp;p=77425" rel="nofollow"><img src="images/buttons/quote.gif" alt="Reply With Quote" border="0" /></a>
<a href="newreply.php?do=newreply&amp;p=77425" rel="nofollow" onclick="return false"><img src="images/buttons/multiquote_off.gif" alt="Multi-Quote This Message" border="0" id="mq_77425" /></a>
<a href="newreply.php?do=newreply&amp;p=77425" rel="nofollow" id="qr_77425" onclick="return false"><img src="images/buttons/quickreply.gif" alt="Quick reply to this message" border="0" /></a>
<!-- / controls -->
</div>
<!-- message, attachments, sig -->
</td>
</tr>
</table>
<!-- post 77425 popup menu -->
<div class="vbmenu_popup" id="postmenu_77425_menu" style="display:none;">
<table cellpadding="4" cellspacing="1" border="0">
<tr>
<td class="thead">Paul Newport</td>
</tr>
<tr><td class="vbmenu_option"><a href="member.php?u=7664">View Public Profile</a></td></tr>
<tr><td class="vbmenu_option"><a href="private.php?do=newpm&amp;u=7664" rel="nofollow">Send a private message to Paul Newport</a></td></tr>
<tr><td class="vbmenu_option"><a href="search.php?do=finduser&amp;u=7664" rel="nofollow">Find all posts by Paul Newport</a></td></tr>
<tr><td class="vbmenu_option"><a href="profile.php?do=addlist&amp;userlist=buddy&amp;u=7664">Add Paul Newport to Your Contacts</a></td></tr>
</table>
</div>
<!-- / post 77425 popup menu -->
</div>
</div>
</div>
</div>
<!-- / close content container -->
<!-- / post #77425 --><div id="lastpost"></div></div></body></html>